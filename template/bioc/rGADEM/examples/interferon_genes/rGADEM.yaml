#############################################################################################################################
# Prepare the following data objects in text, Excel or R files to run this analysis
# <seq> the file that stores the sequences. The file format allowed depends on the <parameter:input:type> value:
#   - "DNAStringSet": must be a file in R format: .rds, .rda, or .rdata
#   - "GRanges": must be a file in R format: .rds, .rda, or .rdata
#   - "bed": must be a .bed file with at least 3 columns: chromosome, start, and end; Optionally, the 6th column is the strand
#   - "character": a file can be read in using the ImportVector function: .rds, .rda, .rdata, .txt, .csv, .xlxs, etc.
# <reference> The name of the BSgenome package having the reference genome
#   - only needed when the sequences are provided as genomic regions stored in a .bed file or GRanges object
#   - call available.genomes() to get a list of reference genomes pre-compiled as BSgenome objects
#   - make sure the chromosome names of the reference genome and genomic location match to each other
#   - https://bioconductor.org/packages/release/bioc/html/BSgenome.html
#########################################################
# As a parameter
# <parameter:input:type> the type of file format the sequences are stored, that can take one of the following values
#   - "DNAStringSet": an R DNAStringSet object, with all the DNA sequences
#   - "GRanges": an R GRanges object object of the genomic locations of the sequences, a reference genome also needs to be provided
#   - "bed": a .bed file with genomic regions of the sequences, a reference genome also needs to be provided
#   - "character": a character vector of actual sequences, without letters other than A, C, G, and T
#############################################################################################################################

###################################################################
#########################    REQUIRED    ##########################
###################################################################
# Required by the RoCA framework to generate a reproducible report
template: https://raw.githubusercontent.com/zhezhangsh/RoCA/master/template/bioc/rGADEM/rGADEM.Rmd
#template: rGADEM.Rmd
output: examples/interferon_genes # Where to save the output files
home: https://github.com/zhezhangsh/RoCA  # Location to project home (URL or local file)
analyst: Jim Zhang                        # Name of the analyst who runs this analysis
zip: no                                   # Whether to zip the output folder

###################################################################
##########################    ABOUT    ############################
###################################################################
description:    
  Project: rGADAM wrapper
  Analysis: Search for DNA motifs around TSS of a number of interferon response genes.

###################################################################
########################    INPUT DATA    #########################
###################################################################
# Location (local or URL) of files with formatted input data
input:    
  seq: https://raw.githubusercontent.com/zhezhangsh/RoCA/master/data/genomic.region/promoter_interferon.rds # File that stores the DNA sequences
  reference: # BSgenome.Hsapiens.NCBI.GRCh38  # The name of the BSgenome package of the reference genome; only needed if <seq> is a set of genomic regions
  
###################################################################
########################    PARAMETER    ##########################
###################################################################
# Location (local or URL) of files with formatted input data
parameter:
  # ==========================================================================================================================
  # GADEM(Sequences,seed=1,genome=NULL,verbose=FALSE,numWordGroup=3,numTop3mer=20,
  #       numTop4mer=40,numTop5mer=60,numGeneration=5,populationSize=100,
  #       pValue=0.0002,eValue=0.0,extTrim=1,minSpaceWidth=0,maxSpaceWidth=10,
  #       useChIPscore=0,numEM=40,fEM=0.5,widthWt=80,fullScan=0,slideWinPWM=6,
  #       stopCriterion=1,numBackgSets=10,weightType=0,
  #       bFileName="NULL",Spwm="NULL",minSites =-1,maskR=0,nmotifs=25)
  #
  # R implementation of GADEM, a powerful computational tools for de novo motif discovery.
  # ==========================================================================================================================
  GADEM: # Parameters for the GADEM {rGADEM} function call; the <Sequences> and <genome> parameters are provided as input data
    # Sequences: ~   #  Provided as input data; see above: input$seq
    # genome: ~      #  Provided as input data; see above: input$seq$BSgenome$package
    pValue: 0.0002 # "P-value cutoff for declaring BINDING SITES (default: 0.0002)."
    numEM: 80      # "Number of EM steps (default: 40)."
    maskR: 1       # "Mask low-complexity sequences or repeats (default: 0-no masking,1-masking)"
    nmotifs: 25    # "Number of motifs sought (default: 25)"
  
  ###################################################################
  # Extra parameters
  rematch: # re-match discovered motifs to original sequences
    sampling: 100000 # Number of random sampling of PWM bases to calculate background distribution of matching scores.
    pvalue: 0.005    # The top portion of random matching scores to be used as cutoff of rematch
    cluster: 4      # Number of clusters for parallel computing

  ###################################################################
  # input
  input:
    type: character
    
######################    END OF DOCUMENT    ######################


