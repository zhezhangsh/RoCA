dir()
d <- readRDS('tSNE_data.rds')
dim(d)
head(d)
sd <- apply(d, 1, sd)
length(sd[sd>1.5])
e <- t(d[sd>1.5, ])
dim(e)
library(tsne)
ts <- tsne(e, perplexity = 2)
dim(ts)
plot(ts)
dim(e)
e <- apply(e, 2, function(x) scale(x))
dim(e)
summary(e[, 1])
dim(e)
ts <- tsne(e, perplexity = 2)
plot(ts)
ts <- tsne(e, perplexity = 1)
plot(ts)
dim(e)
x <- t(e)
s <- readRDS('tSNE_sample.rds')
dim(s)
s
aov <- apply(x, 1, function(x) summary(aov(x~as.factor(s[, 1])))[[1]])
aov[[1]]
aov[[1]][1, 5]
p <- sapply(aov, function(x) x[1, 5])
hist(p, br=100)
min(p)
length(p[p<0.01])
length(p[p<0.00001])
x <- x[p<0.000001, ]
dim(x)
e <- t(x)
dim(e)
ts <- tsne(e, perplexity = 1)
plot(e)
colnames(x)
colnames(d)
plot(e, col=rep(2:4, 6))
plot(e, col=rep(2:4, 6), pch=19)
dim(d)
ts <- tsne(e, perplexity = 2)
plot(e, col=rep(2:4, 6), pch=19)
ts <- tsne(e, perplexity = 30)
plot(e, col=rep(2:4, 6), pch=19)
plot(ts)
ts <- tsne(e, perplexity = 1)
plot(ts)
dim(e)
plot(e)
plot(ts)
plot(ts, col=rep(2:4, each=6))
dim(x)
a <- e[sd>1.5,]
dim(e)
a <- d[sd>1.5,]
dim(a)
ts <- tsne(a)
dim(ts)
plot(ts)
plot(ts, pch=19)
plot(ts, pch=19, col=8)
head(ts)
dim(d)
dim(e)
dim(x)
dim(a)
rownames(ts) <- rownames(a)
ts[1:2, ]
colnames(ts) <- c('tSNE_1', 'tSNE_2')
saveRDS(ts, '~/Desktop/ts.rds')
dim(ts)
dim(a)
a[c('HBB', 'CA1'), ]
a[c('HBB', 'CA1'), ]->b
plot(t(b))
r <- cor(a, a['HBB', ])
r <- cor(t(a),  a['HBB', ])
cor(t(b))
hist(r)
r <- as.vector(r)
hist(r)
head(r)
names(r) <- rownames(a)
rev(sort(r))
head(rev(sort(r)))
library("pcaMethods", lib.loc="~/Library/R/3.2/library")
dim(a)
pc <- pca(a, nPcs=6)
sc <- pc@scores
dim(sc)
pc <- pca(t(a), nPcs=6)
sc <- pc@scores
dim(sc)
plot(sc[, 1:2])
plot(sc[, 1:2], col=rep(2:4, 6))
ts <- tsne(sc)
ts
dim(ts)
plot(ts)
plot(ts, col=rep(2:4, 6))
ts <- tsne(sc, perplexity = 1)
plot(ts)
plot(ts, col=rep(2:4, 6))
ts <- tsne(sc, perplexity = 2)
plot(ts, col=rep(2:4, 6))
ts <- tsne(sc, perplexity = 3)
plot(ts, col=rep(2:4, 6))
ts <- tsne(sc, perplexity = 2)
plot(ts, col=rep(2:4, 6))
dim(d)
pc <- pca(t(d), nPcs=12)
sc <- pc@scale
dim(sc)
sc <- pc@scores
dim(sc)
plot(sc[, 1:2])
ts <- tsne(sc, perplexity = 2)
dim(ts)
plot(ts)
plot(ts, col=rep(2:4, 6))
barplot(ts[, 1])
colnames(a)
plot(ts)
ts <- tsne(sc, perplexity = 1)
plot(ts)
plot(ts, pch=19, col=rep(2:4, 6))
ts <- tsne(sc, perplexity = 5)
plot(ts)
plot(ts, pch=19, col=rep(2:4, 6))
colnames(a)
plot(ts, pch=rep(18:19, each=9), col=rep(2:4, 6))
ts <- tsne(sc, perplexity = 3)
plot(ts, pch=rep(18:19, each=9), col=rep(2:4, 6))
ts <- tsne(sc, perplexity = 4)
plot(ts, pch=rep(18:19, each=9), col=rep(2:4, 6))
ts <- tsne(sc, perplexity = 2)
plot(ts, pch=rep(18:19, each=9), col=rep(2:4, 6))
plot(ts, pch=rep(18:19, each=9), col=rep(1:6, each=3))
