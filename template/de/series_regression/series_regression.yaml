#############################################################################################################################
# Prepare the following data objects in text, Excel or R files to run this analysis
# <data> a numeric matrix saved in a .txt, .tab, .csv, .xlxs, .xls, .rdata, .rda, or .rds file
#   - the first column is unique Entrez gene ID
#   - the first row is unique sample names
#   - for transcriptome data, it's preferred to have data normalized between samples and log2-transformed
# <annotation> a table saved in a .txt, .tab, .csv, .xlxs, .xls, .rdata, .rda, or .rds file
#   - the first column is unique Entrez gene ID matching the row names of <data>
#   - the second column is official gene symbols matching the gene IDs
# <sample> a table saved in a .txt, .tab, .csv, .xlxs, .xls, .rdata, .rda, or .rds
#   - !!! rows must be ordered by the column corresponding to data series
#   - first column is unique sample names matching column names of <data>
#   - first row is unique sample features such as genotype, treatment, and cell type
#   - the values of parameters <term> must match one of the column names in this table
# <geneset> a list of 2 elements saved in a .rdata, .rda, or .rds file
#   - see https://raw.githubusercontent.com/zhezhangsh/RoCA/master/data/gene.set for examples
#   - the first element of the list is a table of gene set annotation
#   - the second element of this list is itself of a list of gene-gene set mapping
#   - the element names of the seconde element must match the row names of the first element
#############################################################################################################################

####################
##### REQUIRED #####
####################
# Required fields for generating any report using the RoCA::CreateReport() function
template: https://raw.githubusercontent.com/zhezhangsh/RoCA/master/template/de/cluster_gene/series_regression.Rmd  # URL or file name of the .Rmd template file provided by the developer
#template: series_regression.Rmd
output: examples/circadian_rhythm                                                   # Where to write all the output files
home: http://zhezhangsh.github.io/RoCA                                              # URL or path to the project home page. Leave it empty if the page doesn't exist.
analyst: Zhe Zhang                                                                  # Name of the analyst
zip: no                                                                             # Whether to zip all output files

#################
##### ABOUT #####
#################
# Description of this analysis, could be any name/text pairs
description: 
  Project: Perturbed rhythmic activation of signaling pathways in mice deficient for Sterol Carrier Protein
          2-dependent diurnal lipid transport and metabolism. (**[GSE67426](http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE67426)**)
  PubMed: "Jouffe C, Gobet C, Martin E, MÃ©tairon S et al. Perturbed rhythmic activation of signaling pathways 
          in mice deficient for Sterol Carrier Protein 2-dependent diurnal lipid transport and metabolism. 
          Sci Rep 2016 Apr 21;6:24631. PMID: [27097688](http://www.ncbi.nlm.nih.gov/pubmed/27097688)."
  Experimental design: Comparison of liver mRNA expression from Scp2 KO and wild-type mice harvested every 2 hours during 3 consecutive days.
          Circadian rhythm in mouse liver, wild type mice only, 3 replicates every 2 hours (12 groups).
  Analysis: Each gene was adjusted to its 0 hour mean and rescaled to make its standard deviation equal to 0. 
          This analysis looks for genes with continuous increased or decreased expression from 0 (midnight) to 12 hour (noon).

######################
##### INPUT DATA #####
######################
# Prepared input data, saved in .rds format using the saveRDS() function
input: # Location of input files
#  data: https://raw.githubusercontent.com/zhezhangsh/RoCA/master/data/gex/circadian_rhythm/expr_0_12.rds     ## a matrix of data, row=gene, column=sample 
  data: expr_0_12.rds     ## a matrix of data, row=gene, column=sample 
    # The order of the samples in the matrix matters, order them based on the order of the groups
    # It's optional to rescale the data matrix to make the mean and SD of rows comparable to each other, or normalize the data on the fly
    # No missing values allowed, remove rows with missing values or run imputation if estimate missing values
#  annotation: https://raw.githubusercontent.com/zhezhangsh/RoCA/master/data/gex/circadian_rhythm/anno.rds     ## a data frame of gene annotation 
  annotation: anno.rds     ## a data frame of gene annotation 
    # Row names match the row names of the data matrix
    # First column should be official gene symbol
#  sample: https://raw.githubusercontent.com/zhezhangsh/RoCA/master/data/gex/circadian_rhythm/sample_0_12.rds    ## a data frame of sample manifest
  sample: sample_0_12.rds    ## a data frame of sample manifest
    # Row names match the column names of the data matrix
    # One column (specify it in parameter:term) should be the variable of interest that will classify samples into multiple groups
    # Order the samples the way you want to show them in the output
#  geneset: https://raw.githubusercontent.com/zhezhangsh/RoCA/master/data/gene.set/mouse.rds                   ## collection of gene sets, availble online
  geneset: https://raw.githubusercontent.com/zhezhangsh/RoCA/master/data/gene.set/mouse.rds ## collection of gene sets, availble online
    # the first is metadata of gene sets, 
    # the second is a list of gene set-gene mapping
    # refer to the rchive (github.com/zhezhangsh/rchive) repo for how to create a gene set collection

######################
##### PARAMETERS #####
######################
# Parameters to run this analysis
parameter: # All parameters
  series: time of the day ## Text description of the data series (days, dosages, etc.)
  term: Group             ## Corresponding to a column name in sample; based on which sample groups will be ordered as a series
  normalization: 2        ## Method of normalization. 0: no normalization; 1: mean=0 & SD=1 for all row;  2: normalize to a the first group
  correlation: spearman   ## "pearson", "kendall", or "spearman"; the <method> option of the <cor> function
  selection:              ## How significant genes will be selected as seeds for initiating clusters
    min: 200          ### Minimal number of genes to be selected for each direction
    max: 1000         ### Maximum number of genes to be selected for each direction
    corr: 0.6         ### First selection criteria, the minimum of correlation coefficient; not applicable after less than minimum
    fdr: 0.05         ### Second selection criteria, maximum FDR value (BH method); not applicable after less than minimum
    p: 0.01           ### Third selection criteria, maximum ANOVA p value; not applicable after less than minimum
    range: 2.0        ### Last selection criteria, the difference of max and min values; not applicable after less than minimum
