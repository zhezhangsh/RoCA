---
title: "Summarize three pairwise comparisons of differential expression"
author: "Zhe Zhang"
date: "2016-06-29"
output:
  html_document:
    number_sections: yes
    self_contained: no
    toc: yes
    toc_float:
      collapsed: no
---

<div style="border:black 1px solid; padding: 0.5cm 0.5cm">
**Introduction**: This analysis is based on the outputs of pairwise comparisons of differential gene expression generated by [this](https://raw.githubusercontent.com/zhezhangsh/RoCA/master/template/de/pairwise_comparison/pairwise_comparison.Rmd) template. It uses results from 3 pairwise comparisons of 3 sample groups vs. their corresponding control groups and compares how these 3 sample groups are different from each other in terms of their sample-control differences (_delta-delta_). An example of such analysis is the different responses of 3 cell types to the treatment of the same drug. This analysis is focused on the overlapping of differentially expression at both gene and gene set levels.

</div>

&nbsp;





<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div> 

# Description
  
## Project


Transcriptome in immune cells of control-patient samples


## Data


Rna-seq data was generated from of 3 types of immune cells of 3 controls and 3 patients. Raw data was processed to get gene-level read counts. Pairwise comparisons were performed between controls and patients in each immune cell.


## Analysis


This is a demo.



<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div> 

## Pairwise comparisons

This report compares the results of the  following pairwise comparisons.  


  - **B_Cell**: Control vs. SLE
  - **T_Cell**: Control vs. SLE
  - **Monocyte**: Control vs. SLE

<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div> 

# Gene-level comparison

## Global delta-delta correlation



Both comparisons reported the log ratio of sample and control group means for each gene. The global agreement of log ratios of all genes indicates how much the results of these 3 comparisons are similar to or different from each other. Full table of gene-level statistics side-by-side is [here](table/gene_table.html). 

  - Corr(B_Cell:T_Cell) = 0.244
  - Corr(B_Cell:Monocyte) = 0.208
  - Corr(T_Cell:Monocyte) = 0.26

<div align='center'>
<img src="FIGURE/log_ratio-1.png" title="plot of chunk log_ratio" alt="plot of chunk log_ratio" width="800px" />
</div>

<div style="color:darkblue; padding:0 1cm">
**Figure 1.** This plot shows the global correlation (correlation coefficient = 0.244, 0.208, 0.26) between the 3 pairwise comparisons: **B_Cell**, **T_Cell**, and **Monocyte**. The same 3D plot was showed in 2 different angles.  Genes obtained p values less than 0.01 from any 1, any 2, or all 3 comparisons were highlighted in yellow, orange, or red respectively. The correlatio coefficients between log-ratios of each pair of comparisons are: 
</div>

<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div> 

## Differentially expression genes (DEGs)



Both comparisons identified DEGs from 2 compared groups. Check report of individual comparisons for how the DEGs were selected. Overlapped DEGs identified by all 3 comparisons are worthy of a closer look. 

<div style="color:darkblue; padding:0 2cm">
**Table 1.** Number of DEGs identified by each comparison.
</div>

<div align='center', style="padding:0 2cm">


|         | Total_gene | P < 0.01 | DEG, > control | DEG, < control |
|:--------|:----------:|:--------:|:--------------:|:--------------:|
|B_Cell   |   23272    |   3235   |      984       |      1853      |
|T_Cell   |   23272    |   2130   |      693       |      671       |
|Monocyte |   23272    |   1693   |      501       |      465       |


</div>




<div align='center'>
<img src="FIGURE/deg_overlap_up-1.png" title="plot of chunk deg_overlap_up" alt="plot of chunk deg_overlap_up" width="480px" />
</div>

<div style="color:darkblue; padding:0 2.5cm">
**Figure 2A.** Overlapping of DEGs, higher expression comparing to control groups. Click links to view overlapping genes:

 - [All 3 comparisons](DEG/up_all3.html)
  - [B_Cell and T_Cell](DEG/up_B_Cell_T_Cell.html)
  - [B_Cell and Monocyte](DEG/up_B_Cell_Monocyte.html)
  - [T_Cell and Monocyte](DEG/up_T_Cell_Monocyte.html)
</div>

<div align='center'>
<img src="FIGURE/deg_overlap_dn-1.png" title="plot of chunk deg_overlap_dn" alt="plot of chunk deg_overlap_dn" width="480px" />
</div>

<div style="color:darkblue; padding:0 2.5cm">
**Figure 2B.** Overlapping of DEGs, lower expression comparing to control groups. Click links to view overlapping genes:

 - [All 3 comparisons](DEG/down_all3.html)
  - [B_Cell and T_Cell](DEG/down_B_Cell_T_Cell.html)
  - [B_Cell and Monocyte](DEG/down_B_Cell_Monocyte.html)
  - [T_Cell and Monocyte](DEG/down_T_Cell_Monocyte.html)
</div>

<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div> 

## ANOVA



2-way ANOVA analysis was performed to identify genes responding to **_SLE_** differently in different **_Cell_**. The analysis reported 3 p values, corresponding to the effect of **_SLE_**, **_Cell_**, and their interaction. The analysis identified 1513 significant genes with interaction p values less than 0.01. The full ANOVA results were summarized in a table [here](table/anova_table.html). 

<div align='center'>
<img src="FIGURE/aov_top-1.png" title="plot of chunk aov_top" alt="plot of chunk aov_top" width="800px" />
</div>

<div style="color:darkblue; padding:0 1cm">
**Figure 3.** Examples: the top 4 genes having the most significant interactive p value, among the genes with significant differential expression in at least one of the three pairwise comparisons. 
</div>

<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div> 

# Gene set-level comparison

Genes are often grouped into pre-defined gene sets according to their function, interaction, location, etc. Analysis then can be performed on genes in the same gene set as a unit instead of individual genes.

## Gene set average



Average differential expression of genes in the same gene set. The gene set-level mean of log-ratio were summarized in this table [here](table/geneset_table.html).

<div align='center'>
<img src="FIGURE/geneset_average_plot-1.png" title="plot of chunk geneset_average_plot" alt="plot of chunk geneset_average_plot" width="800px" />
</div>

<div style="color:darkblue; padding:0 1cm">
**Figure 4.**  Each dot represents a gene set and the average log-ratio of all genes in this gene set. The same 3D plot was showed in 2 different angles.

  - Corr(B_Cell:T_Cell) = 0.467
  - Corr(B_Cell:Monocyte) = 0.313
  - Corr(T_Cell:Monocyte) = 0.388
</div>

<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div> 

## Gene set over-representation analysis (ORA)



Each 2-group comparison performs gene set over-representation analysis (ORA) that identifies gene sets over-represented with differentially expressed genes. The results of ORA of both 2-group comparisons are summarized and compared here.  The ORA of each gene set reports an odds ratio and p value. These statistics from both comparisons were combined and listed side-by-side, as well as the difference of their odds ratios and ratio of their p values (p set to 0.5 when not available), in this table [here](table/ora_table.html)

<div style="color:darkblue; padding:0 2cm">
**Table 2.** Gene sets were broken down into subgroups by their sources. Click on the numbers of over-represented gene sets to see a full list. 
</div>

<div align='center', style="padding:0 2cm">


|           |            B_Cell::Higher_in_Control            |              B_Cell::Higher_in_SLE              |            T_Cell::Higher_in_Control            |             T_Cell::Higher_in_SLE              |            Monocyte::Higher_in_Control            |              Monocyte::Higher_in_SLE              |
|:----------|:-----------------------------------------------:|:-----------------------------------------------:|:-----------------------------------------------:|:----------------------------------------------:|:-------------------------------------------------:|:-------------------------------------------------:|
|BioSystems | [438](ORA/BioSystems_B_Cell.Higher_in_SLE.html) | [3212](ORA/BioSystems_B_Cell.Lower_in_SLE.html) | [921](ORA/BioSystems_T_Cell.Higher_in_SLE.html) | [479](ORA/BioSystems_T_Cell.Lower_in_SLE.html) | [684](ORA/BioSystems_Monocyte.Higher_in_SLE.html) | [1095](ORA/BioSystems_Monocyte.Lower_in_SLE.html) |
|KEGG       |    [40](ORA/KEGG_B_Cell.Higher_in_SLE.html)     |    [319](ORA/KEGG_B_Cell.Lower_in_SLE.html)     |    [49](ORA/KEGG_T_Cell.Higher_in_SLE.html)     |    [119](ORA/KEGG_T_Cell.Lower_in_SLE.html)    |    [48](ORA/KEGG_Monocyte.Higher_in_SLE.html)     |    [164](ORA/KEGG_Monocyte.Lower_in_SLE.html)     |
|MSigDb     |   [857](ORA/MSigDb_B_Cell.Higher_in_SLE.html)   |   [4125](ORA/MSigDb_B_Cell.Lower_in_SLE.html)   |  [1565](ORA/MSigDb_T_Cell.Higher_in_SLE.html)   |   [686](ORA/MSigDb_T_Cell.Lower_in_SLE.html)   |  [1024](ORA/MSigDb_Monocyte.Higher_in_SLE.html)   |   [2024](ORA/MSigDb_Monocyte.Lower_in_SLE.html)   |
|OMIM       |     [0](ORA/OMIM_B_Cell.Higher_in_SLE.html)     |     [1](ORA/OMIM_B_Cell.Lower_in_SLE.html)      |     [0](ORA/OMIM_T_Cell.Higher_in_SLE.html)     |     [0](ORA/OMIM_T_Cell.Lower_in_SLE.html)     |     [0](ORA/OMIM_Monocyte.Higher_in_SLE.html)     |     [0](ORA/OMIM_Monocyte.Lower_in_SLE.html)      |
|PubTator   |  [123](ORA/PubTator_B_Cell.Higher_in_SLE.html)  |  [7634](ORA/PubTator_B_Cell.Lower_in_SLE.html)  |  [632](ORA/PubTator_T_Cell.Higher_in_SLE.html)  |  [892](ORA/PubTator_T_Cell.Lower_in_SLE.html)  | [1726](ORA/PubTator_Monocyte.Higher_in_SLE.html)  |  [1953](ORA/PubTator_Monocyte.Lower_in_SLE.html)  |


</div>



<div align='center'>
<img src="FIGURE/ora_overlap_up-1.png" title="plot of chunk ora_overlap_up" alt="plot of chunk ora_overlap_up" width="480px" />
</div>

<div style="color:darkblue; padding:0 2.5cm">
**Figure 5A.** The overlapping of over-represented gene sets by up-regulated genes in all 3 comparisons. Click links to view overlapping gene sets:

 - [All 3 comparisons](ORA/up_all3.html)
  - [B_Cell and T_Cell](ORA/up_B_Cell_T_Cell.html)
  - [B_Cell and Monocyte](ORA/up_B_Cell_Monocyte.html)
  - [T_Cell and Monocyte](ORA/up_T_Cell_Monocyte.html)
</div>

<div align='center'>
<img src="FIGURE/ora_overlap_dn-1.png" title="plot of chunk ora_overlap_dn" alt="plot of chunk ora_overlap_dn" width="480px" />
</div>

<div style="color:darkblue; padding:0 2.5cm">
**Figure 5B.** The overlapping of over-represented gene sets by down-regulated genes in all 3 comparisons. Click links to view overlapping gene sets:

 - [All 3 comparisons](ORA/down_all3.html)
  - [B_Cell and T_Cell](ORA/down_B_Cell_T_Cell.html)
  - [B_Cell and Monocyte](ORA/down_B_Cell_Monocyte.html)
  - [T_Cell and Monocyte](ORA/down_T_Cell_Monocyte.html)
</div>

<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div> 

## Gene set enrichment analysis (GSEA) 



Each 2-group comparison performs gene set enrichment analysis (GSEA) on genes ranked by their differential expression. The results of GSEA of both 2-group comparisons are summarized and compared here. The GSEA of each gene set reports an enrichment score and p value. These statistics from both comparisons were combined and listed side-by-side in this table [here](table/gsea_table.html)

<div style="color:darkblue; padding:0 2cm">
**Table 3.** Gene sets were broken down into subgroups by collections. Click on the numbers of enriched gene sets to see a full list. 
</div>

<div align='center', style="padding:0 2cm">


|                                      |                         B_Cell::Higher_in_Control                          |                            B_Cell::Higher_in_SLE                            |                          T_Cell::Higher_in_Control                          |                           T_Cell::Higher_in_SLE                            |                          Monocyte::Higher_in_Control                          |                           Monocyte::Higher_in_SLE                            |
|:-------------------------------------|:--------------------------------------------------------------------------:|:---------------------------------------------------------------------------:|:---------------------------------------------------------------------------:|:--------------------------------------------------------------------------:|:-----------------------------------------------------------------------------:|:----------------------------------------------------------------------------:|
|C0_Hallmark                           |              [2](GSEA/C0_Hallmark_B_Cell.Higher_in_SLE.html)               |               [37](GSEA/C0_Hallmark_B_Cell.Lower_in_SLE.html)               |              [12](GSEA/C0_Hallmark_T_Cell.Higher_in_SLE.html)               |               [3](GSEA/C0_Hallmark_T_Cell.Lower_in_SLE.html)               |               [4](GSEA/C0_Hallmark_Monocyte.Higher_in_SLE.html)               |              [15](GSEA/C0_Hallmark_Monocyte.Lower_in_SLE.html)               |
|C1_Positional                         |             [13](GSEA/C1_Positional_B_Cell.Higher_in_SLE.html)             |              [26](GSEA/C1_Positional_B_Cell.Lower_in_SLE.html)              |             [28](GSEA/C1_Positional_T_Cell.Higher_in_SLE.html)              |             [10](GSEA/C1_Positional_T_Cell.Lower_in_SLE.html)              |             [19](GSEA/C1_Positional_Monocyte.Higher_in_SLE.html)              |             [19](GSEA/C1_Positional_Monocyte.Lower_in_SLE.html)              |
|C2_BioCarta_Pathways                  |          [1](GSEA/C2_BioCarta_Pathways_B_Cell.Higher_in_SLE.html)          |          [68](GSEA/C2_BioCarta_Pathways_B_Cell.Lower_in_SLE.html)           |          [14](GSEA/C2_BioCarta_Pathways_T_Cell.Higher_in_SLE.html)          |          [2](GSEA/C2_BioCarta_Pathways_T_Cell.Lower_in_SLE.html)           |          [0](GSEA/C2_BioCarta_Pathways_Monocyte.Higher_in_SLE.html)           |          [20](GSEA/C2_BioCarta_Pathways_Monocyte.Lower_in_SLE.html)          |
|C2_Chemical_and_genetic_perturbations | [36](GSEA/C2_Chemical_and_genetic_perturbations_B_Cell.Higher_in_SLE.html) | [1356](GSEA/C2_Chemical_and_genetic_perturbations_B_Cell.Lower_in_SLE.html) | [411](GSEA/C2_Chemical_and_genetic_perturbations_T_Cell.Higher_in_SLE.html) | [122](GSEA/C2_Chemical_and_genetic_perturbations_T_Cell.Lower_in_SLE.html) | [107](GSEA/C2_Chemical_and_genetic_perturbations_Monocyte.Higher_in_SLE.html) | [353](GSEA/C2_Chemical_and_genetic_perturbations_Monocyte.Lower_in_SLE.html) |
|C3_MicroRNA_targets                   |          [0](GSEA/C3_MicroRNA_targets_B_Cell.Higher_in_SLE.html)           |           [51](GSEA/C3_MicroRNA_targets_B_Cell.Lower_in_SLE.html)           |           [3](GSEA/C3_MicroRNA_targets_T_Cell.Higher_in_SLE.html)           |           [5](GSEA/C3_MicroRNA_targets_T_Cell.Lower_in_SLE.html)           |           [4](GSEA/C3_MicroRNA_targets_Monocyte.Higher_in_SLE.html)           |           [4](GSEA/C3_MicroRNA_targets_Monocyte.Lower_in_SLE.html)           |
|C3_TF_targets                         |             [4](GSEA/C3_TF_targets_B_Cell.Higher_in_SLE.html)              |             [284](GSEA/C3_TF_targets_B_Cell.Lower_in_SLE.html)              |             [12](GSEA/C3_TF_targets_T_Cell.Higher_in_SLE.html)              |             [89](GSEA/C3_TF_targets_T_Cell.Lower_in_SLE.html)              |             [10](GSEA/C3_TF_targets_Monocyte.Higher_in_SLE.html)              |             [85](GSEA/C3_TF_targets_Monocyte.Lower_in_SLE.html)              |
|C4_Cancer_gene_neighborhoods          |     [42](GSEA/C4_Cancer_gene_neighborhoods_B_Cell.Higher_in_SLE.html)      |      [86](GSEA/C4_Cancer_gene_neighborhoods_B_Cell.Lower_in_SLE.html)       |     [170](GSEA/C4_Cancer_gene_neighborhoods_T_Cell.Higher_in_SLE.html)      |      [17](GSEA/C4_Cancer_gene_neighborhoods_T_Cell.Lower_in_SLE.html)      |      [34](GSEA/C4_Cancer_gene_neighborhoods_Monocyte.Higher_in_SLE.html)      |      [57](GSEA/C4_Cancer_gene_neighborhoods_Monocyte.Lower_in_SLE.html)      |
|C4_Cancer_modules                     |           [10](GSEA/C4_Cancer_modules_B_Cell.Higher_in_SLE.html)           |           [176](GSEA/C4_Cancer_modules_B_Cell.Lower_in_SLE.html)            |           [78](GSEA/C4_Cancer_modules_T_Cell.Higher_in_SLE.html)            |           [18](GSEA/C4_Cancer_modules_T_Cell.Lower_in_SLE.html)            |           [28](GSEA/C4_Cancer_modules_Monocyte.Higher_in_SLE.html)            |           [65](GSEA/C4_Cancer_modules_Monocyte.Lower_in_SLE.html)            |
|C6_Oncogenic_signatures               |        [2](GSEA/C6_Oncogenic_signatures_B_Cell.Higher_in_SLE.html)         |        [116](GSEA/C6_Oncogenic_signatures_B_Cell.Lower_in_SLE.html)         |         [9](GSEA/C6_Oncogenic_signatures_T_Cell.Higher_in_SLE.html)         |        [17](GSEA/C6_Oncogenic_signatures_T_Cell.Lower_in_SLE.html)         |        [20](GSEA/C6_Oncogenic_signatures_Monocyte.Higher_in_SLE.html)         |        [20](GSEA/C6_Oncogenic_signatures_Monocyte.Lower_in_SLE.html)         |
|C7_Immunologic_signatures             |       [58](GSEA/C7_Immunologic_signatures_B_Cell.Higher_in_SLE.html)       |       [922](GSEA/C7_Immunologic_signatures_B_Cell.Lower_in_SLE.html)        |       [432](GSEA/C7_Immunologic_signatures_T_Cell.Higher_in_SLE.html)       |       [52](GSEA/C7_Immunologic_signatures_T_Cell.Lower_in_SLE.html)        |       [44](GSEA/C7_Immunologic_signatures_Monocyte.Higher_in_SLE.html)        |       [381](GSEA/C7_Immunologic_signatures_Monocyte.Lower_in_SLE.html)       |
|GO_BP                                 |                [145](GSEA/GO_BP_B_Cell.Higher_in_SLE.html)                 |                 [2065](GSEA/GO_BP_B_Cell.Lower_in_SLE.html)                 |                 [437](GSEA/GO_BP_T_Cell.Higher_in_SLE.html)                 |                 [239](GSEA/GO_BP_T_Cell.Lower_in_SLE.html)                 |                 [321](GSEA/GO_BP_Monocyte.Higher_in_SLE.html)                 |                 [498](GSEA/GO_BP_Monocyte.Lower_in_SLE.html)                 |
|GO_CC                                 |                 [67](GSEA/GO_CC_B_Cell.Higher_in_SLE.html)                 |                 [159](GSEA/GO_CC_B_Cell.Lower_in_SLE.html)                  |                 [120](GSEA/GO_CC_T_Cell.Higher_in_SLE.html)                 |                 [34](GSEA/GO_CC_T_Cell.Lower_in_SLE.html)                  |                 [37](GSEA/GO_CC_Monocyte.Higher_in_SLE.html)                  |                 [50](GSEA/GO_CC_Monocyte.Lower_in_SLE.html)                  |
|GO_MF                                 |                 [44](GSEA/GO_MF_B_Cell.Higher_in_SLE.html)                 |                 [359](GSEA/GO_MF_B_Cell.Lower_in_SLE.html)                  |                 [87](GSEA/GO_MF_T_Cell.Higher_in_SLE.html)                  |                 [71](GSEA/GO_MF_T_Cell.Lower_in_SLE.html)                  |                 [73](GSEA/GO_MF_Monocyte.Higher_in_SLE.html)                  |                 [121](GSEA/GO_MF_Monocyte.Lower_in_SLE.html)                 |
|KEGG_compound                         |             [4](GSEA/KEGG_compound_B_Cell.Higher_in_SLE.html)              |             [126](GSEA/KEGG_compound_B_Cell.Lower_in_SLE.html)              |             [41](GSEA/KEGG_compound_T_Cell.Higher_in_SLE.html)              |             [47](GSEA/KEGG_compound_T_Cell.Lower_in_SLE.html)              |             [44](GSEA/KEGG_compound_Monocyte.Higher_in_SLE.html)              |             [84](GSEA/KEGG_compound_Monocyte.Lower_in_SLE.html)              |
|KEGG_enzyme                           |              [1](GSEA/KEGG_enzyme_B_Cell.Higher_in_SLE.html)               |               [1](GSEA/KEGG_enzyme_B_Cell.Lower_in_SLE.html)                |               [2](GSEA/KEGG_enzyme_T_Cell.Higher_in_SLE.html)               |               [3](GSEA/KEGG_enzyme_T_Cell.Lower_in_SLE.html)               |               [2](GSEA/KEGG_enzyme_Monocyte.Higher_in_SLE.html)               |               [1](GSEA/KEGG_enzyme_Monocyte.Lower_in_SLE.html)               |
|KEGG_module                           |              [11](GSEA/KEGG_module_B_Cell.Higher_in_SLE.html)              |               [13](GSEA/KEGG_module_B_Cell.Lower_in_SLE.html)               |              [24](GSEA/KEGG_module_T_Cell.Higher_in_SLE.html)               |               [3](GSEA/KEGG_module_T_Cell.Lower_in_SLE.html)               |               [5](GSEA/KEGG_module_Monocyte.Higher_in_SLE.html)               |              [10](GSEA/KEGG_module_Monocyte.Lower_in_SLE.html)               |
|KEGG_pathway                          |              [9](GSEA/KEGG_pathway_B_Cell.Higher_in_SLE.html)              |              [161](GSEA/KEGG_pathway_B_Cell.Lower_in_SLE.html)              |              [27](GSEA/KEGG_pathway_T_Cell.Higher_in_SLE.html)              |              [25](GSEA/KEGG_pathway_T_Cell.Lower_in_SLE.html)              |              [7](GSEA/KEGG_pathway_Monocyte.Higher_in_SLE.html)               |              [57](GSEA/KEGG_pathway_Monocyte.Lower_in_SLE.html)              |
|KEGG_reaction                         |             [2](GSEA/KEGG_reaction_B_Cell.Higher_in_SLE.html)              |              [35](GSEA/KEGG_reaction_B_Cell.Lower_in_SLE.html)              |             [24](GSEA/KEGG_reaction_T_Cell.Higher_in_SLE.html)              |             [23](GSEA/KEGG_reaction_T_Cell.Lower_in_SLE.html)              |             [23](GSEA/KEGG_reaction_Monocyte.Higher_in_SLE.html)              |             [27](GSEA/KEGG_reaction_Monocyte.Lower_in_SLE.html)              |
|OMIM_gene                             |               [1](GSEA/OMIM_gene_B_Cell.Higher_in_SLE.html)                |                [2](GSEA/OMIM_gene_B_Cell.Lower_in_SLE.html)                 |                [2](GSEA/OMIM_gene_T_Cell.Higher_in_SLE.html)                |                [2](GSEA/OMIM_gene_T_Cell.Lower_in_SLE.html)                |                [0](GSEA/OMIM_gene_Monocyte.Higher_in_SLE.html)                |                [1](GSEA/OMIM_gene_Monocyte.Lower_in_SLE.html)                |
|REACTOME                              |               [92](GSEA/REACTOME_B_Cell.Higher_in_SLE.html)                |                [283](GSEA/REACTOME_B_Cell.Lower_in_SLE.html)                |               [230](GSEA/REACTOME_T_Cell.Higher_in_SLE.html)                |                [63](GSEA/REACTOME_T_Cell.Lower_in_SLE.html)                |                [46](GSEA/REACTOME_Monocyte.Higher_in_SLE.html)                |               [134](GSEA/REACTOME_Monocyte.Lower_in_SLE.html)                |
|WikiPathways                          |              [2](GSEA/WikiPathways_B_Cell.Higher_in_SLE.html)              |              [91](GSEA/WikiPathways_B_Cell.Lower_in_SLE.html)               |              [13](GSEA/WikiPathways_T_Cell.Higher_in_SLE.html)              |              [5](GSEA/WikiPathways_T_Cell.Lower_in_SLE.html)               |              [9](GSEA/WikiPathways_Monocyte.Higher_in_SLE.html)               |              [21](GSEA/WikiPathways_Monocyte.Lower_in_SLE.html)              |


</div>

<div align='center'>
<img src="FIGURE/nes-1.png" title="plot of chunk nes" alt="plot of chunk nes" width="800px" />
</div>

<div style="color:darkblue; padding:0 1cm">
**Figure 6.** This plot shows the global correlation (correlation coefficient = 0.361, 0.2, 0.189) of nominal enrichment scores between the 3 pairwise comparisons: **B_Cell**, **T_Cell**, and **Monocyte**. The same 3D plot was showed in 2 different angles. Gene sets obtained p values less than 0.01 from any 1, any 2, or all 3 comparisons were highlighted in yellow, orange, or red respectively. The correlatio coefficients between enrichment scores of each pair of comparisons are: 

  - Corr(B_Cell:T_Cell) = 0.361
  - Corr(B_Cell:Monocyte) = 0.2
  - Corr(T_Cell:Monocyte) = 0.189
</div>



<div align='center'>
<img src="FIGURE/gsea_overlap_up-1.png" title="plot of chunk gsea_overlap_up" alt="plot of chunk gsea_overlap_up" width="480px" />
</div>

<div style="color:darkblue; padding:0 2.5cm">
**Figure 7A.** The overlapping of enriched gene sets by up-regulated genes in all 3 comparisons. Click links to view overlapping gene sets:

 - [All 3 comparisons](GSEA/up_all3.html)
  - [B_Cell and T_Cell](GSEA/up_B_Cell_T_Cell.html)
  - [B_Cell and Monocyte](GSEA/up_B_Cell_Monocyte.html)
  - [T_Cell and Monocyte](GSEA/up_T_Cell_Monocyte.html)
</div>

<div align='center'>
<img src="FIGURE/gsea_overlap_dn-1.png" title="plot of chunk gsea_overlap_dn" alt="plot of chunk gsea_overlap_dn" width="480px" />
</div>

<div style="color:darkblue; padding:0 2.5cm">
**Figure 7B.** The overlapping of enriched gene sets by down-regulated genes in all 3 comparisons. Click links to view overlapping gene sets:

 - [All 3 comparisons](GSEA/down_all3.html)
  - [B_Cell and T_Cell](GSEA/down_B_Cell_T_Cell.html)
  - [B_Cell and Monocyte](GSEA/down_B_Cell_Monocyte.html)
  - [T_Cell and Monocyte](GSEA/down_T_Cell_Monocyte.html)
</div>

<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div> 

## Gene clustering



The top 1200 genes with significant ANOVA p values (p <= 'r prms$geneset$cluster$panova') were used as seeds to perform a gene-gene clustering analysis and 12 clusters were identified. ORA was performed on the clusters to identify their functional association (see table below); 



<div style="color:darkblue; padding:0 0.5cm">
**Table 4.** This table lists the number of genes in each cluster (click the numbers to see gene lists), the average expression of all genes in a cluster of all sample groups (normalized so the mean of the control groups equals to 0 and the mean is the number of standard deviations), and then the gene sets over-represented in each cluster (click the numbers to see gene set lists). 
</div>

<div align='center', style="padding:0 0.5cm">


|                      ID                      |             Size              | B_Cell::Control | B_Cell::SLE | T_Cell::Control | T_Cell::SLE | Monocyte::Control | Monocyte::SLE |              Gene_set               |
|:--------------------------------------------:|:-----------------------------:|:---------------:|:-----------:|:---------------:|:-----------:|:-----------------:|:-------------:|:-----------------------------------:|
|  [Cluster_1](CLUSTER/Heatmap_Cluster_1.pdf)  | [108](CLUSTER/Cluster_1.html) |        0        |   1.5435    |        0        |   -1.3742   |         0         |    1.1953     |  [609](CLUSTER/ORA_Cluster_1.html)  |
|  [Cluster_2](CLUSTER/Heatmap_Cluster_2.pdf)  | [98](CLUSTER/Cluster_2.html)  |        0        |   1.3704    |        0        |   -1.4543   |         0         |    -1.4314    | [2164](CLUSTER/ORA_Cluster_2.html)  |
|  [Cluster_3](CLUSTER/Heatmap_Cluster_3.pdf)  | [480](CLUSTER/Cluster_3.html) |        0        |   1.6840    |        0        |   1.5731    |         0         |    1.6065     | [1439](CLUSTER/ORA_Cluster_3.html)  |
|  [Cluster_4](CLUSTER/Heatmap_Cluster_4.pdf)  | [123](CLUSTER/Cluster_4.html) |        0        |   1.6020    |        0        |   1.4107    |         0         |    -1.2534    | [1069](CLUSTER/ORA_Cluster_4.html)  |
|  [Cluster_5](CLUSTER/Heatmap_Cluster_5.pdf)  | [303](CLUSTER/Cluster_5.html) |        0        |   -1.6430   |        0        |   -1.6402   |         0         |    -1.5918    | [2441](CLUSTER/ORA_Cluster_5.html)  |
|  [Cluster_6](CLUSTER/Heatmap_Cluster_6.pdf)  | [18](CLUSTER/Cluster_6.html)  |        0        |   0.3060    |        0        |   1.5256    |         0         |    -1.3006    |  [639](CLUSTER/ORA_Cluster_6.html)  |
|  [Cluster_7](CLUSTER/Heatmap_Cluster_7.pdf)  | [122](CLUSTER/Cluster_7.html) |        0        |   1.5202    |        0        |   1.6649    |         0         |    0.6400     | [1108](CLUSTER/ORA_Cluster_7.html)  |
|  [Cluster_8](CLUSTER/Heatmap_Cluster_8.pdf)  | [65](CLUSTER/Cluster_8.html)  |        0        |   -1.3774   |        0        |   1.3512    |         0         |    -1.4642    | [1862](CLUSTER/ORA_Cluster_8.html)  |
|  [Cluster_9](CLUSTER/Heatmap_Cluster_9.pdf)  | [22](CLUSTER/Cluster_9.html)  |        0        |   -1.4537   |        0        |   1.5435    |         0         |    0.1158     |  [938](CLUSTER/ORA_Cluster_9.html)  |
| [Cluster_10](CLUSTER/Heatmap_Cluster_10.pdf) | [63](CLUSTER/Cluster_10.html) |        0        |   -1.5032   |        0        |   -1.3938   |         0         |    1.4290     | [1424](CLUSTER/ORA_Cluster_10.html) |
| [Cluster_11](CLUSTER/Heatmap_Cluster_11.pdf) | [58](CLUSTER/Cluster_11.html) |        0        |   -1.3088   |        0        |   1.0172    |         0         |    1.5528     | [2119](CLUSTER/ORA_Cluster_11.html) |
| [Cluster_12](CLUSTER/Heatmap_Cluster_12.pdf) | [12](CLUSTER/Cluster_12.html) |        0        |   0.0941    |        0        |   -1.4782   |         0         |    1.4278     | [308](CLUSTER/ORA_Cluster_12.html)  |


</div>

<div align='center'>
<img src="FIGURE/clustering_heatmap-1.png" title="plot of chunk clustering_heatmap" alt="plot of chunk clustering_heatmap" width="600px" />
</div>

<div style="color:darkblue; padding:0 2cm">
**Figure 8.**  This plot shows below the average expression levels of each cluster. Data was normalized before the analysis, so the mean of the control groups was zero and the standard deviation of all samples of each gene was 1.0. Values indicate number of standard deviation from mean of relative control group.
</div>

<div align='center'>
<img src="FIGURE/clustering_mean-1.png" title="plot of chunk clustering_mean" alt="plot of chunk clustering_mean" width="750px" />
</div>

<div style="color:darkblue; padding:0 1cm">
**Figure 9.** This plot summarizes the group means and standard errors of all clusters.
</div>

<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div> 

***

# Appendix 

Check out the **[RoCA home page](http://zhezhangsh.github.io/RoCA)** for more information.  

## Reproduce this report

To reproduce this report: 

  1. Find the data analysis template you want to use and an example of its pairing YAML file  [here](https://github.com/zhezhangsh/RoCA/wiki/Templates-and-examples) and download the YAML example to your working directory

  2. To generate a new report using your own input data and parameter, edit the following items in the YAML file:

    - _output_        : where you want to put the output files
    - _home_          : the URL if you have a home page for your project
    - _analyst_       : your name
    - _description_   : background information about your project, analysis, etc.
    - _input_         : where are your input data, read instruction for preparing them
    - _parameter_     : parameters for this analysis; read instruction about how to prepare input data

  3. Run the code below within ***R Console*** or ***RStudio***, preferablly with a new R session:


```r
if (!require(devtools)) { install.packages('devtools'); require(devtools); }
if (!require(RCurl)) { install.packages('RCurl'); require(RCurl); }
if (!require(RoCA)) { install_github('zhezhangsh/RoCAR'); require(RoCA); }

CreateReport(filename.yaml);  # filename.yaml is the YAML file you just downloaded and edited for your analysis
```

If there is no complaint, go to the _output_ folder and open the ***index.html*** file to view report. 

## Session information


```
## R version 3.2.2 (2015-08-14)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: OS X 10.10.5 (Yosemite)
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
##  [1] DEGandMore_0.0.0.9000 snow_0.4-1            rchive_0.0.0.9000    
##  [4] VennDiagram_1.6.17    futile.logger_1.4.1   scatterplot3d_0.3-37 
##  [7] gplots_3.0.1          MASS_7.3-45           htmlwidgets_0.6      
## [10] DT_0.1                awsomics_0.0.0.9000   yaml_2.1.13          
## [13] rmarkdown_0.9.6       knitr_1.13            RoCA_0.0.0.9000      
## [16] RCurl_1.95-4.8        bitops_1.0-6          devtools_1.12.0      
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.5          magrittr_1.5         highr_0.6           
##  [4] stringr_1.0.0        caTools_1.17.1       tools_3.2.2         
##  [7] parallel_3.2.2       KernSmooth_2.23-15   lambda.r_1.1.7      
## [10] withr_1.0.2          htmltools_0.3.5      gtools_3.5.0        
## [13] digest_0.6.9         formatR_1.4          futile.options_1.0.0
## [16] memoise_1.0.0        evaluate_0.9         gdata_2.17.0        
## [19] stringi_1.1.1        jsonlite_0.9.22
```

<div align='right'>_[Go to project home](http://zhezhangsh.github.io/RoCA)_</div>

***
**END OF DOCUMENT**
