<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Zhe Zhang" />

<meta name="date" content="2017-08-09" />

<title>Cluster genes across multiple sample groups</title>

<script src="index_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="index_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="index_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="index_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<link href="index_files/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="index_files/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Cluster genes across multiple sample groups</h1>
<h4 class="author"><em>Zhe Zhang</em></h4>
<h4 class="date"><em>2017-08-09</em></h4>

</div>


<div style="border:black 1px solid; padding: 0.5cm 0.5cm">
<p><strong>Introduction: </strong> This analysis performs a gene-gene clustering procedure that will identify clusters of co-expressed genes across multiple sample groups. It first runs an ANOVA to find genes significantly changed across sample groups and uses these genes as seeds to initiate a number of gene clusters. These clusters will be further refined based on several user-specific paramters. Gene set enrichment analysis is then used to find pre-defined gene sets that are over-represented in each cluster.</p>
<ul>
<li><strong>Selection of differentially expressed gene:</strong> ANOVA is used to get each gene a p value for its differential expression across sample groups and false discovery rates are calculated using the p values. Afterwards, genes are filtered sequentially by their FDR, p value, and range until the number of remaining genes is smaller than a given minimal number.</li>
<li><strong>Gene clustering analysis:</strong> Remaining genes from the last step are used as seeds for the <em>hclust{stat}</em> function to generate a hierchical clustering tree; the tree is cut at a given height to get initial clusters; the cutting height will be lowered if the number of clusters is less than the number of sample groups; the initial clusters are filtered to remove small clusters, and refined to remove outlier genes; initial clusters close to each other are merged; and finally, the clusters are refined through multiple rounds of re-clustering while including genes with less significant ANOVA p values.</li>
<li><strong>Gene set enrichment analysis:</strong> Hypergeometric test is used to find predefined gene sets over-represented in each gene cluster. A collection of gene sets obtained from different sources are available for a few model species and can be found at<br />
<a href="https://github.com/zhezhangsh/RoCA/tree/master/data" class="uri">https://github.com/zhezhangsh/RoCA/tree/master/data</a>.</li>
</ul>
</div>
<p> </p>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
<div id="description" class="section level1">
<h1><span class="header-section-number">1</span> Description</h1>
<div id="project" class="section level2">
<h2><span class="header-section-number">1.1</span> Project</h2>
<p>Perturbed rhythmic activation of signaling pathways in mice deficient for Sterol Carrier Protein 2-dependent diurnal lipid transport and metabolism. (<strong><a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE67426">GSE67426</a></strong>)</p>
</div>
<div id="pubmed" class="section level2">
<h2><span class="header-section-number">1.2</span> PubMed</h2>
<p>Jouffe C, Gobet C, Martin E, Métairon S et al. Perturbed rhythmic activation of signaling pathways in mice deficient for Sterol Carrier Protein 2-dependent diurnal lipid transport and metabolism. Sci Rep 2016 Apr 21;6:24631. PMID: <a href="http://www.ncbi.nlm.nih.gov/pubmed/27097688">27097688</a>.</p>
</div>
<div id="experimental-design" class="section level2">
<h2><span class="header-section-number">1.3</span> Experimental design</h2>
<p>Comparison of liver mRNA expression from Scp2 KO and wild-type mice harvested every 2 hours during 3 consecutive days.</p>
</div>
<div id="analysis" class="section level2">
<h2><span class="header-section-number">1.4</span> Analysis</h2>
<p>Circadian rhythm in mouse liver, wild type mice only, 3 replicates every 2 hours (12 groups). Each gene was adjusted to its 0 hour mean and rescaled to make its standard deviation equal to 0. As a demonstration, only a subset of genes in the original data with high between sample variance were used.</p>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
<div id="data-and-samples" class="section level2">
<h2><span class="header-section-number">1.5</span> Data and samples</h2>
<ul>
<li>There are 2577 total genes</li>
<li>There are 36 total <a href="table/sample.html">samples</a></li>
<li>There are WT_00Hr, WT_02Hr, WT_04Hr, WT_06Hr, WT_08Hr, WT_10Hr, WT_12Hr, WT_14Hr, WT_16Hr, WT_18Hr, WT_20Hr, WT_22Hr sample groups</li>
</ul>
<p>The input data matrix was normalized using sample group <em>WT_00Hr</em> as control, so, the data of each gene was substracted by control group mean and had SD equal to 1.0</p>
<div align="center">
<p><img src="index_files/figure-html/pca-1.png" width="640px" /></p>
</div>
<div style="color:darkblue; padding:0 3cm">
<p><strong>Figure 1.</strong> Principal components analysis (PCA) using all genes. Samples were colored by their groups.</p>
</div>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
</div>
<div id="analysis-and-results" class="section level1">
<h1><span class="header-section-number">2</span> Analysis and results</h1>
<div id="gene-level-summary-statistics-and-anova" class="section level2">
<h2><span class="header-section-number">2.1</span> Gene-level summary statistics and ANOVA</h2>
<p>Summary statistics and ANOVA p value across all sample groups were calculated for each gene.</p>
<ul>
<li><a href="table/anova.html">Summary statistics and ANOVA result.</a></li>
</ul>
<div align="center">
<p><img src="index_files/figure-html/anova_pvalue-1.png" width="640px" /></p>
</div>
<div style="color:darkblue; padding:0 3cm">
<p><strong>Figure 2.</strong> Distribution of ANOVA p values. 821 genes have p values less than 0.01.</p>
</div>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
<div id="identification-of-gene-clusters" class="section level2">
<h2><span class="header-section-number">2.2</span> Identification of gene clusters</h2>
<div id="selection-of-differentially-expressed-genes" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Selection of differentially expressed genes</h3>
<p>Differentially expressed genes (DEGs) were selected as seeds for generating gene clusters, using the following criteria:</p>
<ul>
<li>Select genes with FDR less than 0.1</li>
<li>Stop if less than 100 genes were left; otherwise, select those with ANOVA p values less than 0.01</li>
<li>Stop if less than 100 genes were left; otherwise, select those with range (<em>max-min</em>) greater than 1</li>
<li>If there are still more than 1000 genes left, select the top 1000 with the biggest ranges</li>
</ul>
<p>A total of <strong>232</strong> genes were selected. These genes would be used as seeds to generate gene clusters in the next step.</p>
<div align="center">
<p><img src="index_files/figure-html/hierarchical_clustering-1.png" width="800px" /></p>
</div>
<div style="color:darkblue; padding:0 3cm">
<p><strong>Figure 3.</strong> Hierarchical clustering of samples using all genes (unsupervised) or selected DEGs (supervised).</p>
</div>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
<div id="idetnfication-of-gene-clusters" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Idetnfication of gene clusters</h3>
<p>Gene clusters were identified from the DEG seeds with the following steps:</p>
<ul>
<li>Create a hierchical tree based on gene-gene correlation</li>
<li>Cut the tree at height 1.2, which will classify genes into clusters. Then apply the following steps to refine the clusters</li>
<li>Calculate correlation of each gene to the centroid (median) of its cluster. Remove the genes if the correlation is less than 0.6</li>
<li>Remove clusters with size less than 20% of the expected size (the expected size is 50 if there are 500 genes and 10 clusters)</li>
<li>If there are less than 12 (the number of sample groups) clusters left, reduce the height cutoff by 0.05 and repeat this step until there are enough clusters</li>
<li>Merge the 2 most similar clusters if the correlation of their centroids is greater than or equal to 0.6. Repeat this step until no 2 clusters are that similar</li>
</ul>
<p><strong>8</strong> gene clusters of <strong>221</strong> genes were identified from <strong>232</strong> seed DEGs.</p>
<div align="center">
<p><img src="index_files/figure-html/plot_cluster_mean-1.png" width="600px" /></p>
</div>
<div style="color:darkblue; padding:0 3cm">
<p><strong>Figure 4.</strong> Color of each block corresponds to the average expression (normalized) of each initial gene cluster in each sample (red = higher).</p>
</div>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
<div id="refinement-of-gene-clusters" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Refinement of gene clusters</h3>
<p>The gene clusters identified from the DEG seeds were further refined with the following steps:</p>
<ul>
<li>Select all 821 genes with p values less than 0.01 to continue</li>
<li>Assign selected genes to clusters:</li>
<li>Calculate centroid (median expression level of all genes in the cluster) of each cluster</li>
<li>Calculate correlation coefficient of each gene to centroid of each cluster to get a 821 X 8 matrix</li>
<li>Assign a gene to a cluster if its correlation coefficient to the cluster is greater than 0.6, and the correlation coefficient to any other cluster is at least 0.1 less</li>
<li>Repeat this reclustering steps for 20 times unless the reclustering converged</li>
<li>Finally, remove clusters with number of genes less than 5.525</li>
</ul>
<p>The reclustering didn’t converge after 20 cycles</p>
<p>A total of <strong>554</strong> genes were clustered after refinement.</p>
<div align="center">
<p><img src="index_files/figure-html/plot_recluster_mean-1.png" width="600px" /></p>
</div>
<div style="color:darkblue; padding:0 3cm">
<p><strong>Figure 5.</strong> Color of each block corresponds to the average expression (normalized) of each refined gene cluster in each sample (red = higher).</p>
</div>
<p>More info:</p>
<ul>
<li><a href="table/clustered_data.html">Original data of clustered genes</a> (<a href="table/clustered_data.csv">download table</a>)</li>
<li><a href="table/clustered_stat.html">Statistic result of clustered genes</a> (<a href="table/clustered_stat.csv">download table</a>)</li>
</ul>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
</div>
<div id="analysis-of-individual-clusters" class="section level2">
<h2><span class="header-section-number">2.3</span> Analysis of individual clusters</h2>
<div id="summary-statistics-and-visualization-of-individual-clusters" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Summary statistics and visualization of individual clusters</h3>
<div style="color:darkblue; padding:0 2cm">
<p><strong>Table 1</strong> Summary of individual clusters, with the average expression (normalized) of all genes of each cluster in all sample groups. Click on cluster name for visualization of each cluster: 1). the average and standard error of sample averages in each group; 2). hierarchical sample clustering using all genes of the cluster; and 3). heatmap of all genes and samples of the cluster.</p>
</div>
<div align="center" ,="" style="padding:0 2cm">
<table>
<thead>
<tr class="header">
<th align="left">Cluster</th>
<th align="right">Num_Gene</th>
<th align="right">Mean_WT_00Hr</th>
<th align="right">Mean_WT_02Hr</th>
<th align="right">Mean_WT_04Hr</th>
<th align="right">Mean_WT_06Hr</th>
<th align="right">Mean_WT_08Hr</th>
<th align="right">Mean_WT_10Hr</th>
<th align="right">Mean_WT_12Hr</th>
<th align="right">Mean_WT_14Hr</th>
<th align="right">Mean_WT_16Hr</th>
<th align="right">Mean_WT_18Hr</th>
<th align="right">Mean_WT_20Hr</th>
<th align="right">Mean_WT_22Hr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="cluster/Cluster_1.pdf">Cluster_1</a></td>
<td align="right">74</td>
<td align="right">0</td>
<td align="right">0.320</td>
<td align="right">0.4003</td>
<td align="right">0.4754</td>
<td align="right">-0.0674</td>
<td align="right">-0.8074</td>
<td align="right">-1.3232</td>
<td align="right">-1.7725</td>
<td align="right">-1.4775</td>
<td align="right">-0.8675</td>
<td align="right">-0.4452</td>
<td align="right">0.038</td>
</tr>
<tr class="even">
<td align="left"><a href="cluster/Cluster_2.pdf">Cluster_2</a></td>
<td align="right">92</td>
<td align="right">0</td>
<td align="right">0.220</td>
<td align="right">0.6953</td>
<td align="right">1.1131</td>
<td align="right">1.3442</td>
<td align="right">0.7731</td>
<td align="right">0.5681</td>
<td align="right">-0.5761</td>
<td align="right">-1.1411</td>
<td align="right">-0.8391</td>
<td align="right">-0.4592</td>
<td align="right">-0.140</td>
</tr>
<tr class="odd">
<td align="left"><a href="cluster/Cluster_3.pdf">Cluster_3</a></td>
<td align="right">76</td>
<td align="right">0</td>
<td align="right">0.027</td>
<td align="right">0.4720</td>
<td align="right">0.9529</td>
<td align="right">1.6852</td>
<td align="right">1.7297</td>
<td align="right">1.8217</td>
<td align="right">1.0513</td>
<td align="right">0.1103</td>
<td align="right">-0.0200</td>
<td align="right">-0.1501</td>
<td align="right">-0.150</td>
</tr>
<tr class="even">
<td align="left"><a href="cluster/Cluster_4.pdf">Cluster_4</a></td>
<td align="right">68</td>
<td align="right">0</td>
<td align="right">-0.110</td>
<td align="right">-0.2174</td>
<td align="right">0.0500</td>
<td align="right">0.8026</td>
<td align="right">1.5266</td>
<td align="right">1.9326</td>
<td align="right">1.9415</td>
<td align="right">1.4404</td>
<td align="right">1.0700</td>
<td align="right">0.7313</td>
<td align="right">0.170</td>
</tr>
<tr class="odd">
<td align="left"><a href="cluster/Cluster_5.pdf">Cluster_5</a></td>
<td align="right">22</td>
<td align="right">0</td>
<td align="right">-0.910</td>
<td align="right">-1.3292</td>
<td align="right">-1.3408</td>
<td align="right">-1.3086</td>
<td align="right">-0.8028</td>
<td align="right">-0.5605</td>
<td align="right">1.1441</td>
<td align="right">-0.4487</td>
<td align="right">-0.9260</td>
<td align="right">-1.4410</td>
<td align="right">-0.760</td>
</tr>
<tr class="even">
<td align="left"><a href="cluster/Cluster_6.pdf">Cluster_6</a></td>
<td align="right">41</td>
<td align="right">0</td>
<td align="right">0.120</td>
<td align="right">-0.3093</td>
<td align="right">-1.0027</td>
<td align="right">-1.6774</td>
<td align="right">-1.6972</td>
<td align="right">-1.4500</td>
<td align="right">-0.3144</td>
<td align="right">0.4795</td>
<td align="right">0.2814</td>
<td align="right">-0.7223</td>
<td align="right">-0.760</td>
</tr>
<tr class="odd">
<td align="left"><a href="cluster/Cluster_7.pdf">Cluster_7</a></td>
<td align="right">81</td>
<td align="right">0</td>
<td align="right">-0.360</td>
<td align="right">-0.7090</td>
<td align="right">-0.8816</td>
<td align="right">-1.0076</td>
<td align="right">-0.4168</td>
<td align="right">-0.1783</td>
<td align="right">0.7138</td>
<td align="right">1.1981</td>
<td align="right">1.1456</td>
<td align="right">0.8200</td>
<td align="right">0.290</td>
</tr>
<tr class="even">
<td align="left"><a href="cluster/Cluster_8.pdf">Cluster_8</a></td>
<td align="right">100</td>
<td align="right">0</td>
<td align="right">-0.110</td>
<td align="right">-0.3746</td>
<td align="right">-0.7491</td>
<td align="right">-1.5633</td>
<td align="right">-1.8686</td>
<td align="right">-1.9389</td>
<td align="right">-1.6773</td>
<td align="right">-0.7202</td>
<td align="right">-0.1745</td>
<td align="right">0.1049</td>
<td align="right">0.150</td>
</tr>
</tbody>
</table>
</div>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
<div id="gene-set-enrichment-analysis" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Gene set enrichment analysis</h3>
<p>Find predefined gene sets enriched in gene cluster comparing to the background.</p>
<div style="color:darkblue; padding:0 2cm">
<p><strong>Table 2</strong> Numbers of predefined gene sets significantly enriched in each gene cluster. Gene sets were split based on their sources, such as the NCBI BioSystems and KEGG databases. Click on each number to see list of the gene sets.</p>
</div>
<div align="center" ,="" style="padding:0 2cm">
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">BioSystems</th>
<th align="center">KEGG</th>
<th align="center">MSigDb</th>
<th align="center">PubTator</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cluster_1</td>
<td align="center"><a href="cluster/Cluster_1/BioSystems.html">65</a></td>
<td align="center"><a href="cluster/Cluster_1/KEGG.html">3</a></td>
<td align="center"><a href="cluster/Cluster_1/MSigDb.html">129</a></td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>Cluster_2</td>
<td align="center"><a href="cluster/Cluster_2/BioSystems.html">48</a></td>
<td align="center">0</td>
<td align="center"><a href="cluster/Cluster_2/MSigDb.html">152</a></td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>Cluster_3</td>
<td align="center"><a href="cluster/Cluster_3/BioSystems.html">92</a></td>
<td align="center"><a href="cluster/Cluster_3/KEGG.html">9</a></td>
<td align="center"><a href="cluster/Cluster_3/MSigDb.html">177</a></td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>Cluster_4</td>
<td align="center"><a href="cluster/Cluster_4/BioSystems.html">155</a></td>
<td align="center"><a href="cluster/Cluster_4/KEGG.html">11</a></td>
<td align="center"><a href="cluster/Cluster_4/MSigDb.html">249</a></td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>Cluster_5</td>
<td align="center"><a href="cluster/Cluster_5/BioSystems.html">39</a></td>
<td align="center"><a href="cluster/Cluster_5/KEGG.html">2</a></td>
<td align="center"><a href="cluster/Cluster_5/MSigDb.html">137</a></td>
<td align="center"><a href="cluster/Cluster_5/PubTator.html">1</a></td>
</tr>
<tr class="even">
<td>Cluster_6</td>
<td align="center"><a href="cluster/Cluster_6/BioSystems.html">54</a></td>
<td align="center"><a href="cluster/Cluster_6/KEGG.html">6</a></td>
<td align="center"><a href="cluster/Cluster_6/MSigDb.html">186</a></td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>Cluster_7</td>
<td align="center"><a href="cluster/Cluster_7/BioSystems.html">77</a></td>
<td align="center"><a href="cluster/Cluster_7/KEGG.html">2</a></td>
<td align="center"><a href="cluster/Cluster_7/MSigDb.html">134</a></td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>Cluster_8</td>
<td align="center"><a href="cluster/Cluster_8/BioSystems.html">105</a></td>
<td align="center"><a href="cluster/Cluster_8/KEGG.html">10</a></td>
<td align="center"><a href="cluster/Cluster_8/MSigDb.html">119</a></td>
<td align="center">0</td>
</tr>
</tbody>
</table>
</div>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
</div>
<div id="more-plots" class="section level2">
<h2><span class="header-section-number">2.4</span> More plots</h2>
<div align="center">
<p><img src="index_files/figure-html/plot_series-1.png" width="750px" /></p>
</div>
<div style="color:darkblue; padding:0 2cm">
<p><strong>Figure 6.</strong> Plot the patterns of all clusters using the mean and standard error of samples of each group.</p>
</div>
<p> </p>
<div align="center">
<p><img src="index_files/figure-html/plot_means-1.png" width="480px" /></p>
</div>
<div style="color:darkblue; padding:0 3cm">
<p><strong>Figure 7.</strong> Color represents the average expression (normalized across samples) of all genes in the same cluster and all samples in the same group (red = higher).</p>
</div>
<p> </p>
<div align="center">
<p><img src="index_files/figure-html/plot_group_means-1.png" width="480px" /></p>
</div>
<div style="color:darkblue; padding:0 3cm">
<p><strong>Figure 8.</strong> Color represents the average expression (normalized across samples) of individual genes in all samples of the same group (red = higher).</p>
</div>
<p> </p>
<div align="center">
<p><img src="index_files/figure-html/plot_heatmap-1.png" width="600px" /></p>
</div>
<div style="color:darkblue; padding:0 3cm">
<p><strong>Figure 9.</strong> Color represents the expression level (normalized across samples) of each gene and each sample (red = higher).</p>
</div>
<p> </p>
<div align="center">
<p><img src="index_files/figure-html/plot_recluster_size-1.png" width="480px" /></p>
</div>
<div style="color:darkblue; padding:0 3cm">
<p><strong>Figure 10.</strong> Color represents the size of each cluster (number of genes) after a reclustering cycle.</p>
</div>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
<hr />
</div>
</div>
<div id="appendix" class="section level1">
<h1><span class="header-section-number">3</span> Appendix</h1>
<p>Check out the <strong><a href="http://zhezhangsh.github.io/RoCA">RoCA home page</a></strong> for more information.</p>
<div id="reproduce-this-report" class="section level2">
<h2><span class="header-section-number">3.1</span> Reproduce this report</h2>
<p>To reproduce this report:</p>
<ol style="list-style-type: decimal">
<li><p>Find the data analysis template you want to use and an example of its pairing YAML file <a href="https://github.com/zhezhangsh/RoCA/wiki/Templates-and-examples">here</a> and download the YAML example to your working directory</p></li>
<li><p>To generate a new report using your own input data and parameter, edit the following items in the YAML file:</p>
<ul>
<li><em>output</em> : where you want to put the output files</li>
<li><em>home</em> : the URL if you have a home page for your project</li>
<li><em>analyst</em> : your name</li>
<li><em>description</em> : background information about your project, analysis, etc.</li>
<li><em>input</em> : where are your input data, read instruction for preparing them</li>
<li><em>parameter</em> : parameters for this analysis; read instruction about how to prepare input data</li>
</ul></li>
<li><p>Run the code below within <strong><em>R Console</em></strong> or <strong><em>RStudio</em></strong>, preferablly with a new R session:</p></li>
</ol>
<pre class="r"><code>if (!require(devtools)) { install.packages(&#39;devtools&#39;); require(devtools); }
if (!require(RCurl)) { install.packages(&#39;RCurl&#39;); require(RCurl); }
if (!require(RoCA)) { install_github(&#39;zhezhangsh/RoCAR&#39;); require(RoCA); }

CreateReport(filename.yaml);  # filename.yaml is the YAML file you just downloaded and edited for your analysis</code></pre>
<p>If there is no complaint, go to the <em>output</em> folder and open the <strong><em>index.html</em></strong> file to view report.</p>
</div>
<div id="session-information" class="section level2">
<h2><span class="header-section-number">3.2</span> Session information</h2>
<pre><code>## R version 3.2.2 (2015-08-14)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: OS X 10.10.5 (Yosemite)
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] rchive_0.0.0.9000   gplots_3.0.1        htmlwidgets_0.8    
##  [4] DT_0.2              RoCA_0.0.0.9000     awsomics_0.0.0.9000
##  [7] RCurl_1.95-4.8      bitops_1.0-6        devtools_1.13.2    
## [10] yaml_2.1.13         rmarkdown_1.3       knitr_1.14         
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.12       magrittr_1.5       highr_0.6         
##  [4] stringr_1.2.0      caTools_1.17.1     tools_3.2.2       
##  [7] KernSmooth_2.23-15 withr_1.0.2        htmltools_0.3.5   
## [10] gtools_3.5.0       rprojroot_1.2      digest_0.6.12     
## [13] formatR_1.4        memoise_1.1.0      evaluate_0.9      
## [16] gdata_2.17.0       stringi_1.1.1      backports_1.1.0   
## [19] jsonlite_1.0</code></pre>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
<hr />
<p><em>END OF DOCUMENT</em></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
