abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=1.5);
segments(i, min(x), i, max(x), lwd=1.5);
points(rep(i, length(y)), y, pch=20, col='#FF00FF', cex=2);
points(rep(i, length(x)), x, pch=18, col='#FFFF00DD', cex=2);
}
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 1) r1 <- c() else r1 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s1)]));
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 6/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1.25/max(strwidth(nm, units = 'in'));
cx <- min(3, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=1.5);
segments(i, min(x), i, max(x), lwd=1.5);
points(rep(i, length(y)), y, pch=20, col='#FF00FFDD', cex=2);
points(rep(i, length(x)), x, pch=18, col='#FFFF00DD', cex=2);
}
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 1) r1 <- c() else r1 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s1)]));
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 6/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1.25/max(strwidth(nm, units = 'in'));
cx <- min(3, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=1.5);
segments(i, min(x), i, max(x), lwd=1.5);
points(rep(i, length(y)), y, pch=20, col='#FF00FFDD', cex=2);
points(rep(i, length(x)), x, pch=18, col='#FFFF00BB', cex=2);
}
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 1) r1 <- c() else r1 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s1)]));
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 6/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1.25/max(strwidth(nm, units = 'in'));
cx <- min(3, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=1.5);
segments(i, min(x), i, max(x), lwd=1.5);
points(rep(i, length(y)), y, pch=20, col='#FF00FFBB', cex=2);
points(rep(i, length(x)), x, pch=18, col='#FFFF00BB', cex=2);
}
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 1) r1 <- c() else r1 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s1)]));
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 6/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1.25/max(strwidth(nm, units = 'in'));
cx <- min(3, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=1.5);
segments(i, min(x), i, max(x), lwd=1.5);
points(rep(i, length(y)), y, pch=20, col='#FF00FFBB', cex=2);
points(rep(i, length(x)), x, pch=18, col='#00FFFFBB', cex=2);
}
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 1) r1 <- c() else r1 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s1)]));
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 6/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1.25/max(strwidth(nm, units = 'in'));
cx <- min(3, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=1.5);
segments(i, min(x), i, max(x), lwd=1.5);
points(rep(i, length(y)), y, pch=20, col='#00FFFFBB', cex=2);
points(rep(i, length(x)), x, pch=18, col='#FF00FFBB', cex=2);
}
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 1) r1 <- c() else r1 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s1)]));
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 6/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1.25/max(strwidth(nm, units = 'in'));
cx <- min(3, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=2, col='darkgrey');
segments(i, min(x), i, max(x), lwd=2, col='darkgrey');
points(rep(i, length(y)), y, pch=20, col='#00FFFFBB', cex=2);
points(rep(i, length(x)), x, pch=18, col='#FF00FFBB', cex=2);
}
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 1) r1 <- c() else r1 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s1)]));
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 6/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1.25/max(strwidth(nm, units = 'in'));
cx <- min(3, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1, lwd=1.5);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=2, col='darkgrey');
segments(i, min(x), i, max(x), lwd=2, col='darkgrey');
points(rep(i, length(y)), y, pch=20, col='#00FFFFBB', cex=2);
points(rep(i, length(x)), x, pch=18, col='#FF00FFBB', cex=2);
}
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 1) r1 <- c() else r1 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s1)]));
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 6/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1.25/max(strwidth(nm, units = 'in'));
cx <- min(3, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1, lwd=1.5);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=2, col='darkgrey');
segments(i, min(x), i, max(x), lwd=2, col='darkgrey');
points(rep(i, length(y)), y, pch=20, col='gold', cex=2);
points(rep(i, length(x)), x, pch=18, col='purple', cex=2);
}
crr
saveRDS(corr, paste(path.r, 'correlation_all.rds', sep='/'));
saveRDS(crr, paste(path.r, 'correlation_pair.rds', sep='/'));
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 1) r1 <- c() else r1 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s1)]));
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 5/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1/max(strwidth(nm, units = 'in'));
cx <- min(1.5, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1, lwd=1.5);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=2, col='darkgrey');
segments(i, min(x), i, max(x), lwd=2, col='darkgrey');
points(rep(i, length(y)), y, pch=20, col='gold', cex=1);
points(rep(i, length(x)), x, pch=18, col='purple', cex=1);
}
crr[[1]]
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 0) r1 <- c() else r1 <- as.vector(cor(mtrx[, id, drop=FALSE], mtrx[, rownames(s1), drop=FALSE]));
names(r1) <- rownames(s1);
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 5/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1/max(strwidth(nm, units = 'in'));
cx <- min(1.5, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1, lwd=1.5);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=2, col='darkgrey');
segments(i, min(x), i, max(x), lwd=2, col='darkgrey');
points(rep(i, length(y)), y, pch=20, col='gold', cex=1);
points(rep(i, length(x)), x, pch=18, col='purple', cex=1);
}
crr[[1]]
names(crr)
crr <- lapply(rownames(smpl), function(id) {
s1 <- smpl[smpl[[1]]==smpl[id, 1] & rownames(smpl)!=id, , drop = FALSE];
if (nrow(s1) == 0) r1 <- c() else r1 <- as.vector(cor(mtrx[, id, drop=FALSE], mtrx[, rownames(s1), drop=FALSE]));
names(r1) <- rownames(s1);
s2 <- smpl[smpl[, 1]!=smpl[id, 1] & smpl[, 2]==smpl[id, 2], ];
if (ncol(smpl) > 3) s2 <- s2[s2[, 3]==smpl[id, 3], , drop=FALSE];
if (nrow(s2) == 0) r2 <- c() else r2 <- as.vector(cor(mtrx[, id], mtrx[, rownames(s2)]));
names(r2) <- rownames(s2);
list(technical=r1, biological=r2);
});
names(crr) <- rownames(smpl);
mx <- max(unlist(crr));
mn <- min(unlist(crr));
rg <- c(floor(100*mn)/100, ceiling(100*mx)/100);
m1 <- sapply(crr, function(x) mean(x[[1]]));
m2 <- sapply(crr, function(x) mean(x[[2]]));
nm <- names(crr);
ht <- 5/length(nm)/max(strheight(nm, units = 'in'))
wd <- 1/max(strwidth(nm, units = 'in'));
cx <- min(1.5, 200/length(crr));
s <- split(rownames(smpl), smpl[[1]])[unique(smpl[[1]])];
n <- sapply(s, length);
par(mai=c(1.5, 1, 0.25, 0.25));
plot(0, type='n', xlim=c(0, 1+length(crr)), ylim=rg, xaxt='n', xlab='', ylab='Correlation coefficient', cex.lab=2,
xaxs='i', yaxs='i');
mtext(nm, side=1, las=3, outer=FALSE, line=0.1, at=1:length(crr), col=cl1, cex=max(c(ht, wd)));
abline(v=1:length(crr), lwd=1, lty=2, col='#66666666');
abline(v=cumsum(n[-length(n)])+0.5, col='black', lty=1, lwd=1.5);
for (i in 1:length(crr)) {
x <- crr[[i]][[1]];
y <- crr[[i]][[2]];
segments(i, min(y), i, max(y), lwd=2, col='darkgrey');
segments(i, min(x), i, max(x), lwd=2, col='darkgrey');
points(rep(i, length(y)), y, pch=20, col='gold', cex=1);
points(rep(i, length(x)), x, pch=18, col='purple', cex=1);
}
crr[1]
mx1 <- sapply(crr, function(x) rev(x[[1]])[1]);
mx1
mx1 <- sapply(crr, function(x) rev(sort(x[[1]]))[1]);
mx1
mx1 <- lapply(crr, function(x) rev(sort(x[[1]]))[1]);
mx1 <- lapply(crr, function(x) rev(sort(x[[1]]))[1]);
val <- as.vector(unlist(mx1));
val
mx1 <- lapply(crr, function(x) rev(sort(x[[1]]))[1]);
val <- as.vector(unlist(mx1));
ind <- which(val==max(val))[1];
plot(mtrx[, names(mx1)[1]], mtrx[, names(mx1[[ind]])]);
srt <- lapply(crr, function(x) rev(sort(x[[1]]))[1]);
val <- as.vector(unlist(srt));
ind <- which(val==max(val))[1];
mx1 <- c(names(srt)[ind], names(srt[[ind]]));
mx1
cor(mtrx[, mx1])
max(unlist(crr))
srt <- lapply(crr, function(x) sort(x[[1]])[1]);
val <- as.vector(unlist(srt));
ind <- which(val==min(val))[1];
mn1 <- c(names(srt)[ind], names(srt[[ind]]));
mn1
cor(mtrx[, mn1])
x <- lapply(crr, function(x) x[[1]])
min(unlist(x))
srt <- lapply(crr, function(x) rev(sort(x[[1]]))[1]);
val <- as.vector(unlist(srt));
ind <- which(val==max(val))[1];
mx1 <- c(names(srt)[ind], names(srt[[ind]]));
srt <- lapply(crr, function(x) sort(x[[1]])[1]);
val <- as.vector(unlist(srt));
ind <- which(val==min(val))[1];
mn1 <- c(names(srt)[ind], names(srt[[ind]]));
srt <- lapply(crr, function(x) rev(sort(x[[2]]))[1]);
val <- as.vector(unlist(srt));
ind <- which(val==max(val))[1];
mx2 <- c(names(srt)[ind], names(srt[[ind]]));
srt <- lapply(crr, function(x) sort(x[[1]])[1]);
val <- as.vector(unlist(srt));
ind <- which(val==min(val))[1];
mn2 <- c(names(srt)[ind], names(srt[[ind]]));
mn1
mn2
cor(mtrx[, mn2])
mx2
cor(mtrx[, mx2])
mn1
cor(mtrx[, mn1])
cor(mtrx[, mx2])
mn2
cor(mtrx[, mn2])
srt <- lapply(crr, function(x) sort(x[[2]])[1]);
val <- as.vector(unlist(srt));
ind <- which(val==min(val))[1];
mn2 <- c(names(srt)[ind], names(srt[[ind]]));
cor(mtrx[, mn2])
ids <- list('Technical, highest'=mx1, 'Technical, lowest'=mn1, 'Biological, highest'=mx2, 'Biological, lowest'=mn2);
ids
range(mtrx[,1 :2])
srt <- lapply(crr, function(x) rev(sort(x[[1]]))[1]);
val <- as.vector(unlist(srt));
ind <- which(val==max(val))[1];
mx1 <- c(names(srt)[ind], names(srt[[ind]]));
srt <- lapply(crr, function(x) sort(x[[1]])[1]);
val <- as.vector(unlist(srt));
ind <- which(val==min(val))[1];
mn1 <- c(names(srt)[ind], names(srt[[ind]]));
srt <- lapply(crr, function(x) rev(sort(x[[2]]))[1]);
val <- as.vector(unlist(srt));
ind <- which(val==max(val))[1];
mx2 <- c(names(srt)[ind], names(srt[[ind]]));
srt <- lapply(crr, function(x) sort(x[[2]])[1]);
val <- as.vector(unlist(srt));
ind <- which(val==min(val))[1];
mn2 <- c(names(srt)[ind], names(srt[[ind]]));
ids <- list('Technical, highest'=mx1, 'Technical, lowest'=mn1, 'Biological, highest'=mx2, 'Biological, lowest'=mn2);
par(mfrow=c(2, 2), mar=c(4, 4, 2, 2));
for (i in 1:4) {
x <- mtrx[, ids[[i]]];
plot(x[, 1], x[, 2], xlim=range(x), ylim=range(x), pch=19, col='#88888888', cex=0.75);
abline(0, 1, col='blue');
}
srt <- lapply(crr, function(x) rev(sort(x[[1]]))[1]);
val <- as.vector(unlist(srt));
ind <- which(val==max(val))[1];
mx1 <- c(names(srt)[ind], names(srt[[ind]]));
srt <- lapply(crr, function(x) sort(x[[1]])[1]);
val <- as.vector(unlist(srt));
ind <- which(val==min(val))[1];
mn1 <- c(names(srt)[ind], names(srt[[ind]]));
srt <- lapply(crr, function(x) rev(sort(x[[2]]))[1]);
val <- as.vector(unlist(srt));
ind <- which(val==max(val))[1];
mx2 <- c(names(srt)[ind], names(srt[[ind]]));
srt <- lapply(crr, function(x) sort(x[[2]])[1]);
val <- as.vector(unlist(srt));
ind <- which(val==min(val))[1];
mn2 <- c(names(srt)[ind], names(srt[[ind]]));
ids <- list('Technical, highest'=mx1, 'Technical, lowest'=mn1, 'Biological, highest'=mx2, 'Biological, lowest'=mn2);
par(mfrow=c(2, 2), mar=c(4, 4, 2, 2));
for (i in 1:4) {
x <- mtrx[, ids[[i]]];
plot(x[, 1], x[, 2], xlim=range(x), ylim=range(x), pch=19, col='#88888888', cex=0.75,
xlab=colnames(x)[1], ylab=colnames(x)[2], main=names(ids)[i], cex.main=1.5);
abline(0, 1, col='blue');
}
setwd("~/Documents/RoCA/template/qc/technical_replicate/examples/RNAseq")
CreateReport('technical_replicate.yaml')
setwd("~/Documents/RoCA/template/qc/technical_replicate")
CreateReport('technical_replicate.yaml')
setwd("~/Documents/RoCA/template/qc/identify_outlier")
setwd("~/Documents/RoCA/template/qc/technical_replicate")
RoCA::CreateReport('technical_replicate.yaml')
RoCA::CreateReport('technical_replicate.yaml')
setwd("~/Documents/RoCA/template/qc/technical_replicate")
setwd("~/Documents/RoCA/template/qc/technical_replicate")
RoCA::CreateReport('technical_replicate.yaml')
