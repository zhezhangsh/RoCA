expr <- readRDS("/Users/zhangz/Documents/RoCA/template/qc/identify_outlier/examples/preterm_blood/input/normalized.rds")
dir()
grp <- readRDS('group.rds')
grp
expr <- expr[, unlist(grp)]
library(awsomics)
PlotPCA(prcomp(t(expr)), rep(names(grp), each=8))
PlotPCA(prcomp(t(expr)), rep(names(grp), each=8), label=1:32)
e <- expr[, grp[[3]]]
dim(e)
plot(hclust(as.dist(1-cor(e))))
hc <- hclust(as.dist(1-cor(e)))
ct <- cutree(hc,k=2)
ct
grp <- split(names(ct), ct)
grp
library(DEGandMore)
stat <- DeLimma(expr, grp)[[1]]
dim(stat)
hist(stat[, 5], br=100)
s <- stat[order(stat[, 5]), ]
head(s)
anno <- readRDS('anno.rds')
a <- anno[rownames(s), ]
head(a)
a[1:20, ]
a[1:20, ]
PlotVolcano(stat[, 3], stat[, 5])
head(stat)
head(s)
x <- s[s[,3]>2 & s[, 6]<0.01, ]
dim(x)
x
id <- rownames(x)
id
writeLines(id, 'x.txt')
getwd()
expr[id[1], unlist(grp)]
head(s)
x <- s[order(s[, 3]), ]
head(x)
y <- x[x[, 6]<0.01, ]
dim(y)
head(y)
summary(y[, 3])
nrow(y[y[,3]< -2, ])
y <- x[x[, 6]<0.05, ]
dim(y)
y <- x[x[, 6]<0.05 & x[, 3]< -2, ]
dim(y)
y[1:2, ]
writeLines(rownames(y), 'x.txt')
x <- s[rev(sort(s[, 3])), ]
dimM(s)
x <- s[rev(order(s[, 3])), ]
head(x)
x[1:20, ]
x <- s[order(s[, 3]), ]
head(x)
x[1:10, ]
x <- x[x[, 6]<0.05, ]
head(x)
x[1:20, ]
x <- x[x[, 1]>=5, ]
head(x)
