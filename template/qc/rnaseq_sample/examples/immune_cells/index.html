<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Jim Zhang" />

<meta name="date" content="2018-07-02" />

<title>Analysis of RNA-seq samples using read count matrix</title>

<script src="index_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="index_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="index_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="index_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<link href="index_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="index_files/highlightjs-9.12.0/highlight.js"></script>
<script src="index_files/kePrint-0.0.1/kePrint.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Analysis of RNA-seq samples using read count matrix</h1>
<h4 class="author"><em>Jim Zhang</em></h4>
<h4 class="date"><em>2018-07-02</em></h4>

</div>


<div style="border:black 1px solid; padding: 0.5cm 0.5cm">
<p><strong>Introduction</strong> This procedure analyzes the RNA-seq data of multiple samples for quality control purpose. It uses inputs such as gene-level read counts provided in one or multiple integer matrixes using the gene-level read counts, corresponding to different types of read-gene mapping, such as unique vs. multiple mapping and mapping to sense vs. antisense strands. The following steps are included in this analysis:</p>
<ul>
<li><strong>Summary statistics</strong>: the read count data is summarized by sample, gene and mapping type.</li>
<li><strong>Dispersion and normalization</strong>: different normalization methods are compared based on between-sample variance of all genes before and after normalization.</li>
<li><strong>Sample analysis</strong>: X/Y genes are used to predict sample gender; and autosomal genes are used for unsupervised sample clustering.</li>
</ul>
</div>
<p> </p>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
<div id="description" class="section level1 tabset">
<h1><span class="header-section-number">1</span> Description</h1>
<div id="project" class="section level2">
<h2><span class="header-section-number">1.1</span> Project</h2>
<p>Transcriptome in immune cells of control-patient samples</p>
</div>
<div id="data" class="section level2">
<h2><span class="header-section-number">1.2</span> Data</h2>
<p>Rna-seq data was generated from of 3 types of immune cells of 3 controls and 3 patients. Raw data was processed to get gene-level read counts.</p>
</div>
<div id="analysis" class="section level2">
<h2><span class="header-section-number">1.3</span> Analysis</h2>
<p>This is a demo.</p>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
</div>
<div id="summary-statistics" class="section level1">
<h1><span class="header-section-number">2</span> Summary statistics</h1>
<ul>
<li>Number of samples: <strong><em>18</em></strong></li>
<li>Number of genes: <strong><em>25,207</em></strong></li>
<li>Average number of total reads per gene: <strong><em>6328.8</em></strong></li>
<li>Average number of total reads per sample: <strong><em>8,862,836</em></strong></li>
</ul>
<div id="read-count-by-sample" class="section level2">
<h2><span class="header-section-number">2.1</span> Read count by sample</h2>
<p>The total read count per sample is the sum of sequence reads of one sample mapped to all genes. Inconsistency of total reads between samples might suggest data quality issues and affect downstream analysis. For example, low total read count could be caused by high level of RNA degradation or high rate of sequencing errors. <em>Shapiro-Wilk</em> normality test shows that the total read counts of this data set <strong>is normally distributed</strong> (p = 0.21). Samples with extreme total read counts comparing to the others are listed below:</p>
<ul>
<li>Samples with extremly low read count: <strong><em>none</em></strong></li>
<li>Samples with extremly high read count: <strong><em>none</em></strong></li>
</ul>
<p><img src="figure/read_count_sample_hist-1.png" width="600px" /></p>
<p><strong>Figure 1.</strong> Distribution of total read counts of all samples. Total read count per sample (millions):</p>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   6.446   7.491   8.600   8.863  10.050  12.370</code></pre>
</div>
<div id="read-count-by-gene" class="section level2">
<h2><span class="header-section-number">2.2</span> Read count by gene</h2>
<p>Due to the variability of gene length and expression level, it is expected that a large portion of the sequence reads are mapped to a small number of genes. At the same time, a large portion of the genes will have no or few reads mapped to them, making them unsuitable for statistical analysis. The distribution of read counts across genes and the consistency of such distribution between samples also provide information about RNA-seq data quality. In this data set,</p>
<ul>
<li><strong>10.52%</strong> genes have no reads mapped to them in any sample.</li>
<li><strong>35.27%</strong> genes have 1 or less read mapped to them per sample.</li>
<li><strong>48.29%</strong> genes have 5 or less reads mapped to them per sample.</li>
</ul>
<p><img src="figure/read_count_gene_sorted-1.png" width="720px" /></p>
<p><strong>Figure 2.</strong> The total read count of all samples mapped to each gene is used to sort genes from high to low. The cumulative percent of top genes is plotted along gene ranking.</p>
<p> </p>
<p><img src="figure/read_count_gene_top-1.png" width="800px" /></p>
<p><strong>Figure 3.</strong> The cumulative read counts of <a href="table/top_gene_id.html">top 10 genes</a> and the <a href="table/top_gene_count.html">percent of total reads</a> by these genes are calculated for each sample. Samples are ordered by the percents from low to high on the x-axis in this figure. The 2 samples with the lowest and the highest cumulative percents are labeled. The cumulative percents of all samples are then compared to each other to identify samples with extremely lower or higher percents than the other samples:</p>
<ul>
<li>Samples with extremely low percent of reads from top 10 genes: <strong><em>none</em></strong></li>
<li>Samples with extremely high percent of reads from top 10 genes: <strong><em>none</em></strong></li>
</ul>
</div>
<div id="read-count-by-mapping-type" class="section level2">
<h2><span class="header-section-number">2.3</span> Read count by mapping type</h2>
<p>The read-to-gene mapping could be complicated by at least 3 conditions corresponding to 8 mapping types:</p>
<ul>
<li>Whether the read is mapped to one and only one gene or multiple genes: <strong><em>unique vs. multiple</em></strong></li>
<li>Whether both ends of paired end reads are mapped to the same gene or only one end is mapped: <strong><em>paired vs. unpaired</em></strong></li>
<li>Whether the read is mapped to the sense strand or antisense strand of a gene: <strong><em>sense vs. antisense</em></strong></li>
</ul>
<p>This analysis accepts multiple matching matrixes of read counts corresponding to different mapping types. By default, the first matrix corresponds to the most common mapping type and will be used for all the other analyses in this report. In this section, however, read counts of different mapping types are summarized and compared to each other when multiple matrixes are provided.</p>
<p><img src="figure/read_count_type_pie-1.png" width="800px" /></p>
<p><strong>Figure 4.</strong> Total mapped reads of all samples are split by mapping types, such as unique vs. multiple, paired vs. unpaired, and sense vs. antisense. Among the 8 mapping type(s),</p>
<ul>
<li>The most common mapping type is <em>Unique_Paired_As</em> (<em>48.4133%</em> of total mapped reads)</li>
<li>The least common mapping type is <em>Multiple_Unpaired_As</em>, (<em>0.065%</em> of total mapped reads)</li>
</ul>
<p> </p>
<p>When the gene-level read counts of two mapping types are strongly correlated to each other, they can be combined to increase total read counts and hence statistical power of data analysis. Negative or lack of correlation between mapping types might also provide useful information.</p>
<p><img src="figure/read_count_type_corr-1.png" width="600px" /></p>
<p><strong>Figure 5.</strong> The mapping type has the strongest correlation to the first and most common mapping type is identified based on Spearman’s correlation coefficients. The gene-level read counts of both mapping types are plotted in this figure. Click <a href="table/corr_mapping_type.html">here</a> to view correlation coefficients between all pairs of mapping types.</p>
<p> </p>
<p>By comparing read counts of different mapping types to each other, the ratios can be compared between samples for consistency. A sample might have quality issue if it has reads of a mapping type much less or more than the other samples.</p>
<p><img src="figure/read_count_type_heatmap-1.png" width="720px" /></p>
<p><strong>Figure 6.</strong> The relative frequecy of mapping types are calculated for each sample, using the first read count matrix as reference. The frequency of each mapping type are normalized across all samples (Mean = 0 and SD = 1.0). This figure shows the normalized frequency of each mapping type in each sample (red = high). - Mapping type <em>Multiple_Unpaired_Sense</em> has the most “abnormally” high relative frequency (# of standard deviations = <em>0.42</em>) in sample <em>T_Patient_F, B_Control_C</em>. - Mapping type <em>Unique_Unpaired_As</em> has the most “abnormally” low relative frequency (# of standard deviations = <em>-1</em>) in sample <em>T_Patient_F</em>.</p>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
</div>
<div id="dispersion-and-normalization" class="section level1">
<h1><span class="header-section-number">3</span> Dispersion and normalization</h1>
<p>Gene-specific dispersion of RNA-seq read counts is commonly used to evaluate between-sample variance of a data set. Here, the dispersion is estimated by the overall pattern of coefficient of variation (standard deviation devided by average read count) of all genes.</p>
<p><img src="figure/dispersion-1.png" width="800px" /></p>
<p><strong>Figure 7.</strong> <strong>Left</strong>: the distribution of average gene expression level (read count divided by gene length). <strong>Right</strong>: the dispersion of gene expression level between samples, measured as the coefficient of variation. Usually, genes with lower expression will have larger dispersion on average.</p>
<p>There are many ways to normalize RNA-seq data to remove systematic bias between samples, usually based on the assumption that all the samples have the same global distribution. The following analysis performs several different normalization methods and evaluate their impact on data dispersion:</p>
<ul>
<li><strong>Original</strong>: The un-normalized gene-level read counts.</li>
<li><strong>Total_Count</strong>: Rescale data so all the samples have the same total read count.</li>
<li><strong>Median</strong>: Rescale data so all the samples have the same median read count.</li>
<li><strong>Quantile_Quantile</strong>: Make all the samples have exactly the same distribution.</li>
<li><strong>Upper_Quantile</strong>: Rescale data so all the samples have the same upper quantile read count.</li>
<li><strong>Trimmed_Mean</strong>: The “weighted trimmed mean of M-values” method implemented by the <a href="https://bioconductor.org/packages/release/bioc/html/edgeR.html">edgeR</a> package.</li>
<li><strong>Relative_Log</strong>: The “relative log expression” method implemented by the <a href="https://bioconductor.org/packages/release/bioc/html/edgeR.html">edgeR</a> package.</li>
<li><strong>DESeq</strong>: The normalization method of the <a href="https://bioconductor.org/packages/release/bioc/html/DESeq.html">DESeq</a> package.</li>
<li><strong>FPKM</strong>: Fragments Per Kilobase of transcript per Million mapped reads.</li>
<li><strong>TPM</strong>: Transcript per Million mapped reads.</li>
<li><strong>Loess</strong>: Make all the samples have the similar distribution by fitting them to same Loess distribution.</li>
<li><strong>Cyclic_Loess</strong>: The “cyclic loess” method implemented by the <a href="https://bioconductor.org/packages/release/bioc/html/limma.html">limma</a> package.</li>
</ul>
<p>Check <a href="http://bib.oxfordjournals.org/content/early/2012/09/15/bib.bbs046.long">this</a> paper for detailed comparison of normalization methods, and <a href="https://raw.githubusercontent.com/zhezhangsh/DEGandMore/master/R/NormWrapper.R">this</a> function for R code of these normalization methods.</p>
<p><img src="figure/normalization_boxplot-1.png" width="900px" /></p>
<p><strong>Figure 8.</strong> Each panel corresponds to a normalization method, including the boxplots of all samples. Samples are colored by their <strong>Group</strong>.</p>
<p><img src="figure/average_cv-1.png" width="600px" /></p>
<p><strong>Figure 9.</strong> Each boxplot corresponds to a normalization method and the overall distribution of change in coefficient of variation of all genes. The means of all genes are labeled as the read stars. Click <a href="table/Coeff_of_Var.html">here</a> to view the table of coefficients of variation of all genes.</p>
<p> </p>
<p><strong>Table 1.</strong> Summary of coefficient of variation (CV) from each normalization method. The columns are 1) average CV of all genes; 2) correlation of CV between the original read counts and normalized read counts of all genes; 3) the number of gene with decreased CV; 4) the number of genes with increased CV; and 5) the ratio of decreased to increased genes.</p>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Method
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Change(%)
</th>
<th style="text-align:right;">
Corr2Original
</th>
<th style="text-align:right;">
Num_Decrease
</th>
<th style="text-align:right;">
Num_Increase
</th>
<th style="text-align:right;">
Decrease/Increase
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Original
</td>
<td style="text-align:left;">
Original
</td>
<td style="text-align:right;">
1.1953
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NaN
</td>
</tr>
<tr>
<td style="text-align:left;">
CL
</td>
<td style="text-align:left;">
CL
</td>
<td style="text-align:right;">
0.9093
</td>
<td style="text-align:right;">
-23.9246
</td>
<td style="text-align:right;">
0.9700
</td>
<td style="text-align:right;">
20544
</td>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
10.22
</td>
</tr>
<tr>
<td style="text-align:left;">
DESeq
</td>
<td style="text-align:left;">
DESeq
</td>
<td style="text-align:right;">
1.1670
</td>
<td style="text-align:right;">
-2.3660
</td>
<td style="text-align:right;">
0.9900
</td>
<td style="text-align:right;">
14207
</td>
<td style="text-align:right;">
8032
</td>
<td style="text-align:right;">
1.77
</td>
</tr>
<tr>
<td style="text-align:left;">
FPKM
</td>
<td style="text-align:left;">
FPKM
</td>
<td style="text-align:right;">
1.2474
</td>
<td style="text-align:right;">
4.3598
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
5253
</td>
<td style="text-align:right;">
16590
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;">
Linear
</td>
<td style="text-align:left;">
Linear
</td>
<td style="text-align:right;">
0.9567
</td>
<td style="text-align:right;">
-19.9642
</td>
<td style="text-align:right;">
0.9800
</td>
<td style="text-align:right;">
19647
</td>
<td style="text-align:right;">
2907
</td>
<td style="text-align:right;">
6.76
</td>
</tr>
<tr>
<td style="text-align:left;">
Loess
</td>
<td style="text-align:left;">
Loess
</td>
<td style="text-align:right;">
0.9071
</td>
<td style="text-align:right;">
-24.1097
</td>
<td style="text-align:right;">
0.9800
</td>
<td style="text-align:right;">
20680
</td>
<td style="text-align:right;">
1874
</td>
<td style="text-align:right;">
11.04
</td>
</tr>
<tr>
<td style="text-align:left;">
Median
</td>
<td style="text-align:left;">
Median
</td>
<td style="text-align:right;">
1.1731
</td>
<td style="text-align:right;">
-1.8580
</td>
<td style="text-align:right;">
0.9900
</td>
<td style="text-align:right;">
13328
</td>
<td style="text-align:right;">
8561
</td>
<td style="text-align:right;">
1.56
</td>
</tr>
<tr>
<td style="text-align:left;">
QQ
</td>
<td style="text-align:left;">
QQ
</td>
<td style="text-align:right;">
1.1405
</td>
<td style="text-align:right;">
-4.5875
</td>
<td style="text-align:right;">
0.9900
</td>
<td style="text-align:right;">
15883
</td>
<td style="text-align:right;">
5969
</td>
<td style="text-align:right;">
2.66
</td>
</tr>
<tr>
<td style="text-align:left;">
RLE
</td>
<td style="text-align:left;">
RLE
</td>
<td style="text-align:right;">
1.1418
</td>
<td style="text-align:right;">
-4.4743
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
16415
</td>
<td style="text-align:right;">
6139
</td>
<td style="text-align:right;">
2.67
</td>
</tr>
<tr>
<td style="text-align:left;">
Rlog
</td>
<td style="text-align:left;">
Rlog
</td>
<td style="text-align:right;">
0.2918
</td>
<td style="text-align:right;">
-75.5911
</td>
<td style="text-align:right;">
-0.0034
</td>
<td style="text-align:right;">
22084
</td>
<td style="text-align:right;">
470
</td>
<td style="text-align:right;">
46.99
</td>
</tr>
<tr>
<td style="text-align:left;">
TMM
</td>
<td style="text-align:left;">
TMM
</td>
<td style="text-align:right;">
1.1421
</td>
<td style="text-align:right;">
-4.4503
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
16538
</td>
<td style="text-align:right;">
6016
</td>
<td style="text-align:right;">
2.75
</td>
</tr>
<tr>
<td style="text-align:left;">
TC
</td>
<td style="text-align:left;">
TC
</td>
<td style="text-align:right;">
1.2474
</td>
<td style="text-align:right;">
4.3598
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
5372
</td>
<td style="text-align:right;">
16591
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;">
TPM
</td>
<td style="text-align:left;">
TPM
</td>
<td style="text-align:right;">
1.2744
</td>
<td style="text-align:right;">
6.6166
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
4349
</td>
<td style="text-align:right;">
17477
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
UQ
</td>
<td style="text-align:left;">
UQ
</td>
<td style="text-align:right;">
1.1544
</td>
<td style="text-align:right;">
-3.4250
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
13455
</td>
<td style="text-align:right;">
7861
</td>
<td style="text-align:right;">
1.71
</td>
</tr>
<tr>
<td style="text-align:left;">
VST
</td>
<td style="text-align:left;">
VST
</td>
<td style="text-align:right;">
0.1757
</td>
<td style="text-align:right;">
-85.3030
</td>
<td style="text-align:right;">
0.4800
</td>
<td style="text-align:right;">
22551
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7517.00
</td>
</tr>
</tbody>
</table>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
<div id="sample-analysis" class="section level1">
<h1><span class="header-section-number">4</span> Sample analysis</h1>
<p>This section uses read count data to perform several sample-level analyses. The results can be used to identify potential mislabeling, outlier, confounding variable, etc. Read counts normalized by the <em>Loess</em> method are used for all analyses in this section.</p>
<div id="gender-prediction" class="section level2">
<h2><span class="header-section-number">4.1</span> Gender prediction</h2>
<p>When enough genes on X and Y chromosomes have detectable expression, these genes can be used to predict the gender of samples. In case the gender information is already available, the predicted gender can be used to identify potential mislabeling.</p>
<p><img src="figure/gender_pred_plot-1.png" width="640px" /></p>
<p><strong>Figure 10.</strong> The average of Log2(Read Count+1) is calculated for X and Y chromosomes when there are at least 5 genes having detectable expression. The averages of each sample are plotted in this figure as X and Y axes. The averages of each chromosome are used separately to cluster samples using the pamk {fpc} function. If the optimal number of clusters is 2 for both chromosomes, gender prediction will be made, and the samples having predicted gender agreed byt the two chromosomes will be labeled with red (female) or blue (male). Click <a href="table/gender_prediction.html">here</a> to veiw the full table of gender prediction.</p>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
<div id="hierarchical-clustering" class="section level2">
<h2><span class="header-section-number">4.2</span> Hierarchical clustering</h2>
<p>Hierarchical clustering groups samples based on their glabal correlation of all genes. It is a iterative procedure that merges two most similar samples/groups at each step.</p>
<p><img src="figure/hierarchical_clustering-1.png" width="640px" /></p>
<p><strong>Figure 11.</strong> Hierarchical clustering of samples using all autosomal genes. Normalized read counts are log2-transformed before clustering. The vertical position of the common node of two samples indicates their similarity (lower = more similar).</p>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
</div>
<div id="principal-components-analysis" class="section level2 tabset">
<h2><span class="header-section-number">4.3</span> Principal components analysis</h2>
<p>Principal components analysis</p>
<div id="group" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Group</h3>
<p><img src="figure/pca_Group.png" /></p>
</div>
<div id="cell" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Cell</h3>
<p><img src="figure/pca_Cell.png" /></p>
</div>
<div id="disease" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Disease</h3>
<p><img src="figure/pca_Disease.png" /></p>
</div>
<div id="donor" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Donor</h3>
<p><img src="figure/pca_Donor.png" /></p>
<p><strong>Figure 12.</strong> PCA is performed using all autosomal genes after read counts are log2-transformed. The same plot is made in multiple tabs while samples are color-coded based on known sample features.</p>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
<hr />
</div>
</div>
</div>
<div id="appendix" class="section level1">
<h1><span class="header-section-number">5</span> Appendix</h1>
<p>Check out the <strong><a href="http://zhezhangsh.github.io/RoCA">RoCA home page</a></strong> for more information.</p>
<div id="reproduce-this-report" class="section level2">
<h2><span class="header-section-number">5.1</span> Reproduce this report</h2>
<p>To reproduce this report:</p>
<ol style="list-style-type: decimal">
<li><p>Find the data analysis template you want to use and an example of its pairing YAML file <a href="https://github.com/zhezhangsh/RoCA/wiki/Templates-and-examples">here</a> and download the YAML example to your working directory</p></li>
<li><p>To generate a new report using your own input data and parameter, edit the following items in the YAML file:</p></li>
</ol>
<ul>
<li><em>output</em> : where you want to put the output files</li>
<li><em>home</em> : the URL if you have a home page for your project</li>
<li><em>analyst</em> : your name</li>
<li><em>description</em> : background information about your project, analysis, etc.</li>
<li><em>input</em> : where are your input data, read instruction for preparing them</li>
<li><em>parameter</em> : parameters for this analysis; read instruction about how to prepare input data</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Run the code below within <strong><em>R Console</em></strong> or <strong><em>RStudio</em></strong>, preferablly with a new R session:</li>
</ol>
<pre class="r"><code>if (!require(devtools)) { install.packages(&#39;devtools&#39;); require(devtools); }
if (!require(RCurl)) { install.packages(&#39;RCurl&#39;); require(RCurl); }
if (!require(RoCA)) { install_github(&#39;zhezhangsh/RoCAR&#39;); require(RoCA); }

CreateReport(filename.yaml);  # filename.yaml is the YAML file you just downloaded and edited for your analysis</code></pre>
<p>If there is no complaint, go to the <em>output</em> folder and open the <strong><em>index.html</em></strong> file to view report.</p>
</div>
<div id="session-information" class="section level2">
<h2><span class="header-section-number">5.2</span> Session information</h2>
<pre><code>## R version 3.3.3 (2017-03-06)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: OS X Yosemite 10.10.5
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] edgeR_3.16.5               DESeq2_1.14.1             
##  [3] SummarizedExperiment_1.4.0 Biobase_2.34.0            
##  [5] limma_3.30.13              gplots_3.0.1              
##  [7] DEGandMore_0.0.0.9000      snow_0.4-2                
##  [9] awsomics_0.0.0.9000        Rnaseq_0.0.0.9000         
## [11] GenomicRanges_1.26.4       GenomeInfoDb_1.10.3       
## [13] IRanges_2.8.2              S4Vectors_0.12.2          
## [15] BiocGenerics_0.20.0        fpc_2.1-10                
## [17] vioplot_0.2                sm_2.2-5.4                
## [19] htmlwidgets_0.9            DT_0.2                    
## [21] yaml_2.1.16                knitr_1.18                
## [23] rmarkdown_1.10.3           RoCA_0.0.0.9000           
## [25] RCurl_1.95-4.9             bitops_1.0-6              
## [27] devtools_1.13.4            kableExtra_0.9.0          
## 
## loaded via a namespace (and not attached):
##  [1] bit64_0.9-7          RColorBrewer_1.1-2   httr_1.3.1          
##  [4] rprojroot_1.3-2      prabclus_2.2-6       tools_3.3.3         
##  [7] backports_1.1.2      R6_2.2.2             rpart_4.1-10        
## [10] KernSmooth_2.23-15   DBI_0.7              Hmisc_4.1-0         
## [13] lazyeval_0.2.1       colorspace_1.3-2     trimcluster_0.1-2   
## [16] nnet_7.3-12          withr_2.1.1          gridExtra_2.3       
## [19] bit_1.1-12           rvest_0.3.2          htmlTable_1.11.1    
## [22] xml2_1.1.1           checkmate_1.8.5      diptest_0.75-7      
## [25] caTools_1.17.1       scales_0.5.0         DEoptimR_1.0-8      
## [28] mvtnorm_1.0-6        robustbase_0.92-8    genefilter_1.56.0   
## [31] readr_1.1.1          stringr_1.2.0        digest_0.6.13       
## [34] foreign_0.8-67       XVector_0.14.1       base64enc_0.1-3     
## [37] pkgconfig_2.0.1      htmltools_0.3.6      highr_0.6           
## [40] rlang_0.1.6          RSQLite_2.0          rstudioapi_0.7      
## [43] jsonlite_1.5         mclust_5.4           BiocParallel_1.8.2  
## [46] gtools_3.5.0         acepack_1.4.1        magrittr_1.5        
## [49] modeltools_0.2-21    Formula_1.2-2        Matrix_1.2-8        
## [52] Rcpp_0.12.14         munsell_0.4.3        stringi_1.1.6       
## [55] MASS_7.3-45          zlibbioc_1.20.0      flexmix_2.3-14      
## [58] plyr_1.8.4           blob_1.1.0           grid_3.3.3          
## [61] gdata_2.18.0         lattice_0.20-34      splines_3.3.3       
## [64] annotate_1.52.1      hms_0.4.0            locfit_1.5-9.1      
## [67] pillar_1.1.0         geneplotter_1.52.0   XML_3.98-1.9        
## [70] evaluate_0.10.1      latticeExtra_0.6-28  data.table_1.10.4-3 
## [73] gtable_0.2.0         kernlab_0.9-25       ggplot2_2.2.1       
## [76] xtable_1.8-2         class_7.3-14         survival_2.40-1     
## [79] viridisLite_0.2.0    tibble_1.4.2         AnnotationDbi_1.36.2
## [82] memoise_1.1.0        cluster_2.0.5</code></pre>
<div align="right">
<em><a href="http://zhezhangsh.github.io/RoCA">Go to project home</a></em>
</div>
<hr />
<p><em>END OF DOCUMENT</em></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
