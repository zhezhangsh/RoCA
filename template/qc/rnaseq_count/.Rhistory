points(ind, cum.pct[ind], pch='*', cex=1.5);
legend('topleft', bty='n', pch='*', legend=paste(pct, '% total reads: ', ind, ' gene(s)', sep=''), cex=2/3);
box();
gene.ct  <- sort(rowSums(cnt), decreasing = TRUE);
gene.pct <- 100*gene.ct/sum(gene.ct);
cum.pct  <- cumsum(gene.pct); # Cumulative percent of total reads
par(mar=c(5, 5, 2, 2));
plot(1:nrow(cnt), cum.pct, type='l', col='white', log='x', xlab='Number of genes', ylab='Cumulative percent of total reads (%)',
cex.lab=1.75, xaxs='i', yaxs='i', ylim=c(0, 100), yaxt='n');
axis(2, at=seq(0, 100, 25));
abline(h=seq(25, 75, 25), lty=2, col='lightgrey');
polygon(c(1, 1:nrow(cnt), nrow(cnt)), c(0, cum.pct, 0), border=NA, col='#D2B4DE');
# lines(1:nrow(cnt), cum.pct, lwd=2, col='#BB8FCE');
pct <- c(5, 10, 25, 50, 75, 90, 95);
ind <- as.vector(sapply(pct, function(pct) which(cum.pct>pct)[1]));
text(ind, cum.pct[ind], label=ind, col='#2E86C1', pos=4, cex=1.25);
points(ind, cum.pct[ind], pch='*', cex=1.5);
legend('topleft', bty='n', pch='*', legend=paste(pct, '% total reads: ', ind, ' gene(s)', sep=''), cex=2/3);
box();
gene.ct  <- sort(rowSums(cnt), decreasing = TRUE);
gene.pct <- 100*gene.ct/sum(gene.ct);
cum.pct  <- cumsum(gene.pct); # Cumulative percent of total reads
pct <- apply(cnt, 2, function(c) cumsum(100*rev(sort(c))/sum(c)));
col <- rainbow(ncol(cnt));
par(mar=c(5, 5, 2, 2));
plot(0, 0, type='n', col='white', log='x', xlab='Number of genes', ylab='Cumulative percent of total reads (%)',
cex.lab=1.75, xaxs='i', yaxs='i', xlim=c(1, nrow(cnt)), ylim=c(0, 100), yaxt='n');
axis(2, at=seq(0, 100, 25));
abline(h=seq(25, 75, 25), lty=2, col='lightgrey');
box();
gene.ct  <- sort(rowSums(cnt), decreasing = TRUE);
gene.pct <- 100*gene.ct/sum(gene.ct);
cum.pct  <- cumsum(gene.pct); # Cumulative percent of total reads
pct <- apply(cnt, 2, function(c) cumsum(100*rev(sort(c))/sum(c)));
col <- rainbow(ncol(cnt));
par(mar=c(5, 5, 2, 2));
plot(1, 1, type='n', col='white', log='x', xlab='Number of genes', ylab='Cumulative percent of total reads (%)',
cex.lab=1.75, xaxs='i', yaxs='i', xlim=c(1, nrow(cnt)), ylim=c(0, 100), yaxt='n');
axis(2, at=seq(0, 100, 25));
abline(h=seq(25, 75, 25), lty=2, col='lightgrey');
box();
gene.ct  <- sort(rowSums(cnt), decreasing = TRUE);
gene.pct <- 100*gene.ct/sum(gene.ct);
cum.pct  <- cumsum(gene.pct); # Cumulative percent of total reads
pct <- apply(cnt, 2, function(c) cumsum(100*rev(sort(c))/sum(c)));
col <- rainbow(ncol(cnt));
par(mar=c(5, 5, 2, 2));
plot(1, 1, type='n', col='white', log='x', xlab='Number of genes', ylab='Cumulative percent of total reads (%)',
cex.lab=1.75, xaxs='i', yaxs='i', xlim=c(1, nrow(cnt)), ylim=c(0, 100), yaxt='n');
axis(2, at=seq(0, 100, 25));
abline(h=seq(25, 75, 25), lty=2, col='lightgrey');
for (i in 1:ncol(cnt)) lines(c(1, 1:nrow(cnt)), pct[, i]);
gene.ct  <- sort(rowSums(cnt), decreasing = TRUE);
gene.pct <- 100*gene.ct/sum(gene.ct);
cum.pct  <- cumsum(gene.pct); # Cumulative percent of total reads
pct <- apply(cnt, 2, function(c) cumsum(100*rev(sort(c))/sum(c)));
col <- rainbow(ncol(cnt));
par(mar=c(5, 5, 2, 2));
plot(1, 1, type='n', col='white', log='x', xlab='Number of genes', ylab='Cumulative percent of total reads (%)',
cex.lab=1.75, xaxs='i', yaxs='i', xlim=c(1, nrow(cnt)), ylim=c(0, 100), yaxt='n');
axis(2, at=seq(0, 100, 25));
abline(h=seq(25, 75, 25), lty=2, col='lightgrey');
for (i in 1:ncol(cnt)) lines(c(1, 1:nrow(cnt)), c(0, pct[, i]));
box();
gene.ct  <- sort(rowSums(cnt), decreasing = TRUE);
gene.pct <- 100*gene.ct/sum(gene.ct);
cum.pct  <- cumsum(gene.pct); # Cumulative percent of total reads
pct <- apply(cnt, 2, function(c) cumsum(100*rev(sort(c))/sum(c)));
col <- rainbow(ncol(cnt));
par(mar=c(5, 5, 2, 2));
plot(1, 1, type='n', col='white', log='', xlab='Number of genes', ylab='Cumulative percent of total reads (%)',
cex.lab=1.75, xaxs='i', yaxs='i', xlim=c(1, nrow(cnt)), ylim=c(0, 100), yaxt='n');
axis(2, at=seq(0, 100, 25));
abline(h=seq(25, 75, 25), lty=2, col='lightgrey');
for (i in 1:ncol(cnt)) lines(c(1, 1:nrow(cnt)), c(0, pct[, i]));
box();
gene.ct  <- sort(rowSums(cnt), decreasing = TRUE);
gene.pct <- 100*gene.ct/sum(gene.ct);
cum.pct  <- cumsum(gene.pct); # Cumulative percent of total reads
pct <- apply(cnt, 2, function(c) cumsum(100*rev(sort(c))/sum(c)));
col <- rainbow(ncol(cnt));
par(mar=c(5, 5, 2, 2));
plot(1, 1, type='n', col='white', log='x', xlab='Number of genes', ylab='Cumulative percent of total reads (%)',
cex.lab=1.75, xaxs='i', yaxs='i', xlim=c(1, nrow(cnt)), ylim=c(0, 100), yaxt='n');
axis(2, at=seq(0, 100, 25));
abline(h=seq(25, 75, 25), lty=2, col='lightgrey');
for (i in 1:ncol(cnt)) lines(c(1, 1:nrow(cnt)), c(0, pct[, i]), col=col[i]);
box();
col <- rainbow(ncol(cnt));
var <- apply(pct, 1, sd);
var <- apply(pct, 1, sd);
ind <- which(var==max(var));
ind
gene.ct  <- sort(rowSums(cnt), decreasing = TRUE);
gene.pct <- 100*gene.ct/sum(gene.ct);
cum.pct  <- cumsum(gene.pct); # Cumulative percent of total reads
pct <- apply(cnt, 2, function(c) cumsum(100*rev(sort(c))/sum(c)));
col <- rainbow(ncol(cnt));
var <- apply(pct, 1, sd);
ind <- which(var==max(var));
par(mar=c(5, 5, 2, 2));
plot(1, 1, type='n', col='white', log='x', xlab='Number of genes', ylab='Cumulative percent of total reads (%)',
cex.lab=1.75, xaxs='i', yaxs='i', xlim=c(1, nrow(cnt)), ylim=c(0, 100), yaxt='n');
axis(2, at=seq(0, 100, 25));
abline(h=seq(25, 75, 25), lty=2, col='lightgrey');
for (i in 1:ncol(cnt)) lines(c(1, 1:nrow(cnt)), c(0, pct[, i]), col=col[i]);
text(ind, pct[ind, ], label=colnames(cnt), col=col);
box();
PlotMA(1:10, 1:10)
PlotMA
log(0)
log(1)
logged <- log10(cnt);
loged[logged==-Inf] <- 0;
logded[logged==-Inf] <- 0;
logged[logged==-Inf] <- 0;
mn <- rowMeans(logged);
par(mar=c(5,5,2,2));
logged <- log10(cnt);
logged[logged==-Inf] <- 0;
mn <- rowMeans(logged);
cv <- apply(logged, 1, sd)/mn;
plot(mn, cv, pch=19, cex=.5, xaxt='n', cex.lab=1.5, col='#88888888',
xlab='Average read count of all samples', ylab='Coefficient of variation');
axis(1, at=0:ceiling(max(mn)), label=10^(0:ceiling(max(mn))));
lines(lowess(cv~mn), col=4);
# abline(v = dens$x[dens.y==max(dens.y)], lty=3, col=3);
par(mar=c(5,5,2,2));
logged <- log10(cnt);
logged[logged==-Inf] <- 0;
mn <- rowMeans(logged);
cv <- apply(logged, 1, sd)/mn;
plot(mn, cv, pch=19, cex=.5, xaxt='n', cex.lab=1.5, col='#88888888',
xlab='Average read count of all samples', ylab='Coefficient of variation');
axis(1, at=0:ceiling(max(mn)), label=10^(0:ceiling(max(mn))));
# lines(lowess(cv~mn), col=4);
# abline(v = dens$x[dens.y==max(dens.y)], lty=3, col=3);
crr <- cor(log2(cnt+1));
sort(crr[1, ])
length(sort(crr[1, ]))
dim(crr)
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
sort(crr[1, ])
length(sort(crr[1, ]))
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
srt[[1]]
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
mx  <- sapply(srt, function(x) rev(x)[1]);
mn  <- sapply(srt, function(x) x[1]);
mx
mn
names(srt)
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx  <- sapply(srt, function(x) rev(x)[1]);
mn  <- sapply(srt, function(x) x[1]);
mx
x1 <- names(srt)[which(mx==max(mx))];
x1
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
crr[p1[1], p1[2]]
max(crr, na.rm=TRUE)
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
par(mfrow=c(1, 2));
PlotLogScatter(cnt[, p1[1]], cnt[, p1[2]], main=paste('Correlation =', round(crr[p1[1], p1[2]], 4)));
PlotLogScatter(cnt[, p2[1]], cnt[, p2[2]], main=paste('Correlation =', round(crr[p2[1], p2[2]], 4)));
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
par(mfrow=c(1, 2));
PlotLogScatter(cnt[, p1[1]], cnt[, p1[2]], main=paste('Highest Correlation =', round(crr[p1[1], p1[2]], 4)));
PlotLogScatter(cnt[, p2[1]], cnt[, p2[2]], main=paste('Lowest Correlation =', round(crr[p2[1], p2[2]], 4)));
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
par(mfrow=c(1, 2));
PlotLogScatter(cnt[, p1[1]], cnt[, p1[2]], p1[1], p1[2], main=paste('Highest Correlation =', round(crr[p1[1], p1[2]], 4)));
args(PlotLogScatter)
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
par(mfrow=c(1, 2));
PlotLogScatter(cnt[, p1[1]], cnt[, p1[2]], xlab=p1[1], ylab=p1[2],
main=paste('Highest Correlation =', round(crr[p1[1], p1[2]], 4)));
PlotLogScatter(cnt[, p2[1]], cnt[, p2[2]], xlab=p1[1], ylab=p1[2],
main=paste('Lowest Correlation =', round(crr[p2[1], p2[2]], 4)));
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
par(mfrow=c(1, 2));
PlotLogScatter(cnt[, p1[1]], cnt[, p1[2]], xlab=p1[1], ylab=p1[2], col=2,
main=paste('Highest Correlation =', round(crr[p1[1], p1[2]], 4)));
PlotLogScatter(cnt[, p2[1]], cnt[, p2[2]], xlab=p1[1], ylab=p1[2],
main=paste('Lowest Correlation =', round(crr[p2[1], p2[2]], 4)));
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
par(mfrow=c(1, 2));
PlotLogScatter(cnt[, p1[1]], cnt[, p1[2]], xlab=p1[1], ylab=p1[2], col="#E74C3C",
main=paste('Highest Correlation =', round(crr[p1[1], p1[2]], 4)));
PlotLogScatter(cnt[, p2[1]], cnt[, p2[2]], xlab=p1[1], ylab=p1[2], col="#2ECC71",
main=paste('Lowest Correlation =', round(crr[p2[1], p2[2]], 4)));
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
par(mfrow=c(1, 2));
PlotLogScatter(cnt[, p1[1]], cnt[, p1[2]], xlab=p1[1], ylab=p1[2], col="#E74C3C",
main=paste('Highest Correlation =', round(crr[p1[1], p1[2]], 4)));
PlotLogScatter(cnt[, p2[1]], cnt[, p2[2]], xlab=p1[1], ylab=p1[2], col="#1ABC9C",
main=paste('Lowest Correlation =', round(crr[p2[1], p2[2]], 4)));
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
par(mfrow=c(1, 2));
PlotLogScatter(cnt[, p1[1]], cnt[, p1[2]], xlab=p1[1], ylab=p1[2], col="#E74C3C",
main=paste('Highest Correlation =', round(crr[p1[1], p1[2]], 4)));
abline(0, 1);
PlotLogScatter(cnt[, p2[1]], cnt[, p2[2]], xlab=p1[1], ylab=p1[2], col="#1ABC9C",
main=paste('Lowest Correlation =', round(crr[p2[1], p2[2]], 4)));
abline(0, 1);
par(mar=c(5,5,2,2));
logged <- log10(cnt);
logged[logged==-Inf] <- 0;
mn <- rowMeans(logged);
cv <- apply(logged, 1, sd)/mn;
plot(mn, cv, pch=19, cex=.5, xaxt='n', cex.lab=1.5, col='#88888888', xaxs='i',
xlab='Average read count of all samples', ylab='Coefficient of variation');
axis(1, at=0:ceiling(max(mn)), label=10^(0:ceiling(max(mn))));
# lines(lowess(cv~mn), col=4);
# abline(v = dens$x[dens.y==max(dens.y)], lty=3, col=3);
par(mar=c(5,5,2,2));
logged <- log10(cnt);
logged[logged==-Inf] <- 0;
mn <- rowMeans(logged);
cv <- apply(logged, 1, sd)/mn;
plot(mn, cv, pch=19, cex=.5, xaxt='n', cex.lab=1.5, col='#88888888', xaxs='i', yaxs='i',
xlab='Average read count of all samples', ylab='Coefficient of variation');
axis(1, at=0:ceiling(max(mn)), label=10^(0:ceiling(max(mn))));
# lines(lowess(cv~mn), col=4);
# abline(v = dens$x[dens.y==max(dens.y)], lty=3, col=3);
dim(anno)
head(anno)
dim(cnt)
top10
dim(top10)
ids10
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
nnz
write.csv(cnt, paste(path.tbl, 'count.csv', sep='/'));
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
NonZero_N=nnz, 'NonZero(%)'=100*round(nnz/nrow(cnt), 1),
Top_Gene=ids10[1, ],  stringsAsFactors = FALSE)
smm
write.csv(cnt, paste(path.tbl, 'count.csv', sep='/'));
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
ZeroRead=apply(cnt, 2, function(c) length(c[c==0])),
Top_Gene=ids10[1, ],  stringsAsFactors = FALSE)
smm
par(mfrow=c(1, 2));
PlotLogScatter(cnt[, p1[1]], cnt[, p1[2]], xlab=p1[1], ylab=p1[2], col="#E74C3C",
main=paste('Highest Correlation =', round(crr[p1[1], p1[2]], 4)));
abline(0, 1);
PlotLogScatter(cnt[, p2[1]], cnt[, p2[2]], xlab=p1[1], ylab=p1[2], col="#1ABC9C",
main=paste('Lowest Correlation =', round(crr[p2[1], p2[2]], 4)));
abline(0, 1);
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
PlotColoredBlock(crr);
args(PlotColoredBlock)
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
PlotColoredBlock(crr, groups=list(1:9, 10:18));
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
PlotColoredBlock(crr, groups=rep(1:2, each=9));
dim(cnt)
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
PlotColoredBlock(crr, groups=colnames(cnt));
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
PlotColoredBlock(crr, 0, 1, groups=colnames(cnt));
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
PlotColoredBlock(crr, groups=colnames(cnt));
crr <- cor(log2(cnt+1));
for (i in 1:ncol(cnt)) crr[i, i] <- NA;
srt <- lapply(1:nrow(crr), function(i) sort(crr[i, ]));
names(srt) <- rownames(crr);
mx <- sapply(srt, function(x) rev(x)[1]);
mn <- sapply(srt, function(x) x[1]);
p1 <- names(srt)[which(mx==max(mx))];
p2 <- names(srt)[which(mn==min(mn))];
PlotColoredBlock(crr, groups=colnames(cnt), key='Correlation coefficient');
top10
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
ZeroRead=apply(cnt, 2, function(c) length(c[c==0])),
Top_Gene=ids10[1, ], Top10_Pct=round(top10[10, ], 1), stringsAsFactors = FALSE)
write.csv(cnt, paste(path.tbl, 'count.csv', sep='/'));
smm
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
ZeroRead=apply(cnt, 2, function(c) length(c[c==0])),
Top10_Pct=round(top10[10, ], 1), Top_Gene=ids10[1, ], stringsAsFactors = FALSE)
write.csv(cnt, paste(path.tbl, 'count.csv', sep='/'));
srt[[1]]
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
ZeroRead=apply(cnt, 2, function(c) length(c[c==0])),
Top10_Pct=round(top10[10, ], 1), Top_Gene=ids10[1, ], stringsAsFactors = FALSE);
smm$Nearest <- sapply(srt, function(x) rev(names(x))[1]);
smm$Farthest <- sapply(srt, function(x) names(x)[1]);
write.csv(cnt, paste(path.tbl, 'count.csv', sep='/'));
write.csv(crr, paste(path.tbl, 'correlation.csv', sep='/'));
smm
srt[[1]]
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
ZeroRead=apply(cnt, 2, function(c) length(c[c==0])),
Top10_Pct=round(top10[10, ], 1), Top_Gene=ids10[1, ], stringsAsFactors = FALSE);
dir.create(paste(path.fig, 'scatter', sep='/'), showWarnings = FALSE);
ngh <- sapply(rownames(smm), function(id) {
f1 <- paste0('scatter/', id, '_', mx, '.png');
png(f1, width = 800, height = 800);
mx <- names(rev(srt[[id]]))[1];
PlotLogScatter(cnt[, id], cnt[, mx], xlab=id, ylab=mx, col="#E74C3C",
main=paste('Highest Correlation =', round(crr[id, mx], 4)));
abline(0, 1);
dev.off();
})
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
ZeroRead=apply(cnt, 2, function(c) length(c[c==0])),
Top10_Pct=round(top10[10, ], 1), Top_Gene=ids10[1, ], stringsAsFactors = FALSE);
dir.create(paste(path.fig, 'scatter', sep='/'), showWarnings = FALSE);
ngh <- sapply(rownames(smm), function(id) {
f1 <- paste0('scatter/', id, '_', mx, '.png');
png(f1, width = 800, height = 800);
mx <- names(rev(srt[[id]]))[1];
PlotLogScatter(cnt[, id], cnt[, mx], xlab=id, ylab=mx, col="#E74C3C",
main=paste('Highest Correlation =', round(crr[id, mx], 4)));
abline(0, 1);
dev.off();
})
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
ZeroRead=apply(cnt, 2, function(c) length(c[c==0])),
Top10_Pct=round(top10[10, ], 1), Top_Gene=ids10[1, ], stringsAsFactors = FALSE);
dir.create(paste(path.fig, 'scatter', sep='/'), showWarnings = FALSE);
ngh <- sapply(rownames(smm), function(id) {
f1 <- paste0('scatter/', id, '_', mx, '.png');
png(f1, width = 800, height = 800);
mx <- names(rev(srt[[id]]))[1];
PlotLogScatter(cnt[, id], cnt[, mx], xlab=id, ylab=mx, col="#E74C3C",
main=paste('Highest Correlation =', round(crr[id, mx], 4)));
abline(0, 1);
})
write.csv(cnt, paste(path.tbl, 'count.csv', sep='/'));
write.csv(crr, paste(path.tbl, 'correlation.csv', sep='/'));
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
ZeroRead=apply(cnt, 2, function(c) length(c[c==0])),
Top10_Pct=round(top10[10, ], 1), Top_Gene=ids10[1, ], stringsAsFactors = FALSE);
dir.create(paste(path.fig, 'scatter', sep='/'), showWarnings = FALSE);
ngh <- sapply(rownames(smm), function(id) {
f1 <- paste0('scatter/', id, '_', mx, '.png');
png(paste(path.fig, f1, sep='/'), width = 800, height = 800);
mx <- names(rev(srt[[id]]))[1];
PlotLogScatter(cnt[, id], cnt[, mx], xlab=id, ylab=mx, col="#E74C3C",
main=paste('Highest Correlation =', round(crr[id, mx], 4)));
abline(0, 1);
})
write.csv(cnt, paste(path.tbl, 'count.csv', sep='/'));
write.csv(crr, paste(path.tbl, 'correlation.csv', sep='/'));
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
ZeroRead=apply(cnt, 2, function(c) length(c[c==0])),
Top10_Pct=round(top10[10, ], 1), Top_Gene=ids10[1, ], stringsAsFactors = FALSE);
dir.create(paste(path.fig, 'scatter', sep='/'), showWarnings = FALSE);
ngh <- sapply(rownames(smm), function(id) {
mx <- names(rev(srt[[id]]))[1];
f1 <- paste0('scatter/', id, '_', mx, '.png');
png(paste(path.fig, f1, sep='/'), width = 800, height = 800);
PlotLogScatter(cnt[, id], cnt[, mx], xlab=id, ylab=mx, col="#E74C3C",
main=paste('Highest Correlation =', round(crr[id, mx], 4)));
abline(0, 1);
})
write.csv(cnt, paste(path.tbl, 'count.csv', sep='/'));
write.csv(crr, paste(path.tbl, 'correlation.csv', sep='/'));
id <- rownames(smm)[1]
id
mx <- names(rev(srt[[id]]))[1];
dev.cur()
dev.off()
mx <- names(rev(srt[[id]]))[1];
f1 <- paste0('scatter/', id, '_', mx, '.png');
f1
png(paste(path.fig, f1, sep='/'), width = 800, height = 800);
PlotLogScatter(cnt[, id], cnt[, mx], xlab=id, ylab=mx, col="#E74C3C",
main=paste('Highest Correlation =', round(crr[id, mx], 4)));
dev.off()
dev.off()
dev.off()
nnz <- apply(cnt, 2, function(c) length(c[c>0]));
smm <- data.frame(Total=colSums(cnt), Mean=round(colMeans(cnt), 2), Median=apply(cnt, 2, median),
ZeroRead=apply(cnt, 2, function(c) length(c[c==0])),
Top10_Pct=round(top10[10, ], 1), Top_Gene=ids10[1, ], stringsAsFactors = FALSE);
dir.create(paste(path.fig, 'scatter', sep='/'), showWarnings = FALSE);
ngh <- sapply(rownames(smm), function(id) {
mx <- names(rev(srt[[id]]))[1];
f1 <- paste0('scatter/', id, '_', mx, '.png');
png(paste(path.fig, f1, sep='/'), width = 800, height = 800);
PlotLogScatter(cnt[, id], cnt[, mx], xlab=id, ylab=mx, col="#E74C3C",
main=paste('Highest Correlation =', round(crr[id, mx], 4)));
abline(0, 1);
})
mx <- names(rev(srt[[id]]))[1];
mx <- names(rev(srt[[id]]))[1];
mx
f1 <- paste0('scatter/', id, '_', mx, '.png');
png(paste(path.fig, f1, sep='/'), width = 800, height = 800);
path.fig
dir()
f1
png(paste(path.fig, f1, sep='/'), width = 800, height = 800);
