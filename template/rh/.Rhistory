grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=1
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=10
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=-1
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=0.5
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=0.5, margin=20
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=0.5, margin=1
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=0.5, margin=0.5
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=0.5, margin=0.9
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=0.5, margin=0.2
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=0.5, margin=0.2, alpha=rep(0.2, 3)
);
grid.draw(venn.plot);
grid.newpage();
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 1,
scaled=FALSE, area.vector=1, offset=0.5, margin=0.2, alpha=rep(0.8, 3)
);
grid.draw(venn.plot);
grid.newpage();
devtools::install_github('zhezhangsh/awsomicsR')
devtools::install_github('zhezhangsh/awsomicsR')
library("awsomics", lib.loc="~/Library/R/3.3/library")
?
VennDiagram::draw.triple.venn
require(RankProd)
log2(0.7)
log(0.7)
library("affy", lib.loc="~/Library/R/3.3/library")
data(Dilution)
eset <- rma(Dilution)
require(affydata)
data(Dilution)
eset <- rma(Dilution)
e <- exprs(eset)
dim(e)
head(e)
hist(e[, 1])
eset <- rma(Dilution)
e <- exprs(eset)
hist(e[, 1])
d <- exprs(Dilution)
hist(d[, 1])
hist(log2(d[, 1]))
getwd()
setwd('~/Documents/tSNEd/')
dir()
setwd('data')
x <- read.table('zeisel_corr_tsne_1k_runs.csv.gz', sep='\t', he=TRUE)
dim(x)
x <- read.table('zeisel_corr_tsne_1k_runs.csv.gz', sep='\t', he=TRUE, sep='\t')
x <- read.csv('zeisel_corr_tsne_1k_runs.csv.gz', sep='\t', he=TRUE)
dim(x)
x <- read.csv('zeisel_corr_tsne_1k_runs.csv.gz', he=TRUE)
dim(x)
x[1:2, 1:2]
x <- read.csv('zeisel_corr_tsne_1k_runs.csv.gz', he=TRUE, row=1)
dim(x)
i <- seq(1, 2000, 2)
i
a <- lapply(i, function(i) x[, i:(i+1)])
dim(a[[1]])
length(a)
x <- round(x, 3)
a <- lapply(i, function(i) x[, i:(i+1)])
dir()
saveRDS(a, 'zeisel.rds')
dir()
load('zeisel.RData')
ls()
z <- zeisel
rm(zeisel)
length(z)
s <- sample(1:1000, 1000)
ind <- lapply(seq(1, 1000, 10), function(i) s[i:(i+9)])
ind[1:2]
ind <- lapply(ind, sort)
head(ind)
dir()
getwd()
saveRDS(ind, 'random_10runs.rds')
dir('../R')
source('../R/DistConsensus.R')
args(DistConsensus)
dir()
adj <- readRDS('median_distance.rds')
dim(adj)
length(adj)
summary(adj)
adj <- 100/adj
cons <- lapply(1:100, function(i) {print(i); DistConsensus(z[ind[[i]]], adj[i]); })
c <- cons[[1]]
dim(c)
dim(c)
class(c)
cl <- sapply(cons, function(c) cutree(hclust(c), k=9))
dim(cl)
??rand
??rand.index
From fossil v0.3.7
by Matthew J Vavrek
adjustedRandIndex(cl[, 1], cl[, 2])
require(mclust)
adjustedRandIndex(cl[, 1], cl[, 2])
adjustedRandIndex(cl[, 1], cl[, 3])
adjustedRandIndex(cl[, 1], cl[, 4])
length(cl)
dim(cl)
tt <- lapply(1:100, function(i) sample(1:100, 2))
rnd <- sapply(tt, function(i) adjustedRandIndex(cl[, i[1]], cl[, i[2]])
)
rnd
boxplot(rnd)
median(rnd)
mean(rnd)
which(rnd==min(rnd))
c <- cl[, tt[[78]]]
xtabs(~c[,1]+c[,2])
xtabs(~c[, 1]+c[, 2])
xtabs(~cl[, 1]+cl[, 2])
dim(cl)
xtabs(~cl[, 3]+cl[, 4])
dim(c)
dim(cl)
length(z)
cl1 <- sapply(z, function(z) cutree(hclust(z), k=9))
dim(z[[1]])
cl1 <- sapply(z, function(z) cutree(hclust(dist(z)), k=9))
cl1 <- sapply(z[1:100], function(z) cutree(hclust(dist(z)), k=9))
dim(cl1)
xtabs(~cl[, 1]+cl[, 2])
xtabs(~cl1[, 1]+cl1[, 2])
xtabs(~cl1[, 1]+cl1[, 2])->x
xtabs(~cl[, 1]+cl[, 2])->y
length(x[x==0])
length(x[x>0 & x<=5])
length(y[y>0 & y<=5])
n1 <- sapply(1:100, function(i) {j <- sample(1:100, 2); a <- xtabs(~cl1[, j[1]]+cl1[, j[2]]); length(a[a>0&a<=5])})
n1
n2 <- sapply(1:100, function(i) {j <- sample(1:100, 2); a <- xtabs(~cl[, j[1]]+cl[, j[2]]); length(a[a>0&a<=5])})
n1
n2
boxplot(n1, n2)
??DNAStringSet
seq <- 'GAGACCTCCTCCATGATCCCTTGTC
CCTGGCATTAGACTTCTGGGGCTTA
ATGGGCAGCATTCCGAGTAAGATGT
TAGGAGAGAGACGCATCAGCCAGAG
AAGGTGCTCTGTCATTGCCTCAGTC
TCTTTGGCTCTCCGTTCAGAGTTGT
TAAAGGCACGTCTGTGTCAGGTGAG
GTTGTGGGTGCTATATGGGCTTTGG
ACTGTTCAGCACGATGTTAGGGACT
TAATGCAACCAACTCTCAAGCGAGC
CCTGCCTCTGTATGGAACCTAACCTG
GAGGAAAGCAACTTCTCACAGGCAG
CATGTTCTCCGCTGTTGGCTTTGTT
GTTGTGGGTGCTATATGGGCTTTGG
AGGCATTCCCACATTCCCATACACT
TTCCTTGGAGGGTTTCTGCTACGAA
AAGCTGACCTCAACGGGACAAGTAA
GAGTCAGAGGGGAAGAGCAAAACCT
GAGGTCCGAATAGTAAACAGCAGCG
CCCTTATCCAGGCAACTCTCCTCTC
TAAGACCCTGCTAAACCTCTGGGCA
TAACGGGAGAAGAGATGGTCACTCC
CAGACTCAGGAGGGCACTAGAACTG
GCAAGTTATCATCAGTCTCAGCGCC
GCGCAAAGTCACAACACTTAATGGG
TGACATCTGCACTCCCTACATGAGC
TCTCACTAAGCACTCGCCCATTCTT
ATGAGAGGAGGGAGAGGTCATAGGG
CATCATCCCGCTAGGTCTTGTTCCT
AAGCTGAGAATGGTACACTGCCGAA
ATTTCCCTTTCGTGGTGCTGCTTTT
GATGTCAACAACTACCTGCCCAACC
GACTGCCACCCCACAACTCATTCTA
TCTAGTTTCTTACCGGCAGGCACTT
CTGCAACAAAGCAGGAAGAGGTTCG
GCACAGTAAAGGGGCTTCATGCTTTT
CAGGAGCTGGCTAGACTGTGTTTCA
AAGCTGATGGGCTCTAAGGTGTTCA
CTCTCCAACACCTACTTGAGGGCTT
AAAGTGTTTGGTCAGTCCTCTCCCA
TAAGGGGCATGGCTAAAAGGAGAGG
CTACAGAGACACGGGTTAGTGCTGT
GTCCAGGTTCCTACACCTTTCCTGA
TTTGTCCCCTAGCTCCACTTTGACC
CTCCAGAGAACTGGCTGGTAAGTGT
GGTTCTTCACCCAGAGCCTAAAACG
TGACTTTGCGGATGGGAGAAAAGG
AGGTTCCTGGGAGTTTATGTCA
GATTGAGAGCACAAGCGCATACCAA
CAATCTCCTGCTTACCAAAGCTCCG
AACGTCACTCTTTCCTTCCGGTTTG
ATGCCTCCACACCTGCCAAT
GAGCTGTTTCCTGCCCAAACTAAGG
CCCAACTAAAGGCTGGGGAAACTTG
AATTGCCCAGAGTAGAGGGAATGGG
ATCTGCAAACTCTCGCCTTCAGAGA
TTGAAAGTCCCTCCACACAGTACCC
AAGCACCACTACCATCCTACCACTG
GGATTAAGGGTTGAGGGGCATGAGA
GCAGGAGATGCTGAAGAGATGCTTG
GCTGTGTGGTCTCCCTCTTAGCA
CCTCCTTTCATCACCCGTCATTGTG
GATTTTGGTGGTAGAGGAAAGGCCG
GACTCTCACCAGGGCAGTAGATAGC
TCCAGCTCTTCCTGTTGGTGTGTAA
GGCCCACCCCTGATGACTACTAAAA
CTCCAGCTAACTTCCAGGGTCTCAG
TTGGAGCAAAAGCAAGAGGAATGGC
GCATTCACACTGCCACCCAATACAA
GTGTGGTGGATGATAGCTCAGTTGC
GTTCCTACCTTCACTGCCCATCCTT
AGCTCAACCCATAACCTCAACCACA
ACCTTTTAACTCTATACCCTGCCACA'
seq
seq <- strsplit(seq, '\n')[[1]]
seq
seq <- seq[seq!='']
length(seq)
id <- 'inpSeqchr9:133249602:133281214_3_O21
inpSeqchr9:133249602:133281214_7_O65
inpSeqchr9:133249602:133281214_12_O81
inpSeqchr9:133249602:133281214_15_O119
inpSeqchr4:144103304:144146751_1_O10
inpSeqchr4:144103304:144146751_4_O36
inpSeqchr4:144103304:144146751_7_O65
inpSeqchr4:144103304:144146751_9_O89
inpSeqchr4:144103304:144146751_12_O112
inpSeqchr4:144103304:144146751_15_O142
inpSeqchr4:144103304:144146751_18_O180
inpSeqchr4:144103304:144146751_21_O204
inpSeqchr4:143990106:144025339_4_O39
inpSeqchr4:143990106:144025339_6_O59
inpSeqchr4:143990106:144025339_12_O111
inpSeqchr4:143990106:144025339_15_O131
inpSeqchr4:143990106:144025339_18_O166
inpSeqchr1:25266393:25336445_2_O16
inpSeqchr1:25266393:25336445_5_O46
inpSeqchr1:25266393:25336445_8_O77
inpSeqchr1:25266393:25336445_11_O109
inpSeqchr1:25266393:25336445_13_O128
inpSeqchr1:25266393:25336445_17_O164
inpSeqchr1:25266393:25336445_21_O202
inpSeqchr1:25266393:25336445_23_O224
inpSeqchr1:25266393:25336445_26_O240
inpSeqchr1:25266393:25336445_29_O266
inpSeqchr1:25266393:25336445_32_O301
inpSeqchr1:25356249:25426845_2_O16
inpSeqchr1:25356249:25426845_6_O57
inpSeqchr1:25356249:25426845_9_O83
inpSeqchr1:25356249:25426845_11_O102
inpSeqchr1:25356249:25426845_14_O125
inpSeqchr1:25356249:25426845_18_O163
inpSeqchr1:25356249:25426845_21_O194
inpSeqchr1:25356249:25426845_24_O219
inpSeqchr1:25356249:25426845_27_O256
inpSeqchr1:25356249:25426845_31_O287
inpSeqchr1:25356249:25426845_34_O321
inpSeqchr1:25356249:25426845_38_O360
inpSeqchr19:48742011:48761390_1_O1
inpSeqchr19:48742011:48761390_4_O32
inpSeqchr19:48742011:48761390_6_O56
inpSeqchr19:48742011:48761390_9_O86
inpSeqchr19:48689975:48711950_2_O1
inpSeqchr19:48689975:48711950_6_O42
inpSeqchr19:48689975:48711950_9_O77
inpSeqchr19:48689975:48711950_11_O95
inpSeqchr19:5836891:5857474_1_O5
inpSeqchr19:5836891:5857474_5_O47
inpSeqchr19:5836891:5857474_8_O67
inpSeqchr19:5836891:5857474_11_O89
inpSeqchr1:159197307:159212498_3_O22
inpSeqchr1:159197307:159212498_6_O56
inpSeqchr1:159197307:159212498_8_O72
inpSeqchr7:142935114:142968681_1_O2
inpSeqchr7:142935114:142968681_4_O37
inpSeqchr7:142935114:142968681_8_O71
inpSeqchr7:142935114:142968681_11_O102
inpSeqchr7:142935114:142968681_14_O131
inpSeqchr7:142935114:142968681_17_O169
inpSeqchr18:45718127:45758520_2_O13
inpSeqchr18:45718127:45758520_5_O50
inpSeqchr18:45718127:45758520_8_O72
inpSeqchr18:45718127:45758520_11_O107
inpSeqchr18:45718127:45758520_14_O131
inpSeqchr18:45718127:45758520_17_O163
inpSeqchr18:45718127:45758520_20_O199
inpSeqchr19:44803103:44827414_2_O11
inpSeqchr19:44803103:44827414_5_O46
inpSeqchr19:44803103:44827414_7_O67
inpSeqchr19:44803103:44827414_9_O89
inpSeqchr19:44803103:44827414_13_O111'
id
id <- strsplit(id, '\n')[[1]]
id
id <- id[id!='']
length(id)
id
id <- sub('inpSeq', '', id)
id
names(seq) <- id
dir()
setwd('~/Documents/RoCA/template/rh/')
getwd()
saveRDS(seq, 'rh_primer.rds')
dir()
getwd()
